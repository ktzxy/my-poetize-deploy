server:
  port: ${SERVER_PORT:8081}
  tomcat:
    threads.max: 100
    max-connections: 200
    max-http-form-post-size: 120MB
    connection-timeout: 60000

mybatis-plus:
  mapper-locations: classpath*:mapper/**/*.xml
  configuration:
    map-underscore-to-camel-case: true
#    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      logic-delete-value: 1
      logic-not-delete-value: 0

spring:
  servlet:
    multipart:
      max-file-size: 100MB
      max-request-size: 100MB

  web:
    resources:
      # 关键配置：让 Spring Boot 从文件系统加载静态资源
      static-locations: file:/app/static/, classpath:/static/

  mail:
    host: ${MAIL_HOST:smtp.qq.com}
    # 发件人邮箱地址（请修改为你的QQ邮箱）
    username: ${MAIL_USERNAME:}
    # QQ邮箱授权码（不是QQ密码，需要在QQ邮箱设置中获取）
    password: ${MAIL_PASSWORD:}
    default-encoding: utf-8
    protocol: smtp
    port: ${MAIL_PORT:465}
    properties:
      mail:
        smtp:
          socketFactory:
            port: 465
            class: javax.net.ssl.SSLSocketFactory
          ssl:
            enable: true
          auth: true
          starttls:
            enable: true
            required: true

  datasource:
    username: ${MYSQL_USERNAME:poetize}
    password: ${MYSQL_PASSWORD:P192003839@zy}
    url: jdbc:mysql://${MYSQL_HOST:localhost}:${MYSQL_PORT:3306}/${MYSQL_DATABASE:poetize}?allowPublicKeyRetrieval=true&useSSL=true&useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai
    type: com.alibaba.druid.pool.DruidDataSource
    driver-class-name: com.mysql.cj.jdbc.Driver
    # Druid连接池配置
    druid:
      # 初始化连接数
      initial-size: 5
      # 最小空闲连接数
      min-idle: 5
      # 最大活跃连接数
      max-active: 20
      # 获取连接等待超时时间（毫秒）
      max-wait: 60000
      # 配置间隔多久进行一次检测，检测需要关闭的空闲连接（毫秒）
      time-between-eviction-runs-millis: 60000
      # 配置连接在池中的最小生存时间（毫秒）
      min-evictable-idle-time-millis: 300000
      # 测试连接是否有效的SQL
      validation-query: SELECT 1
      # 申请连接时执行validationQuery检测连接是否有效
      test-while-idle: true
      # 申请连接时不检测（性能优化）
      test-on-borrow: false
      # 归还连接时不检测（性能优化）
      test-on-return: false
      # 是否缓存preparedStatement
      pool-prepared-statements: true
      # 每个连接上PSCache的大小
      max-pool-prepared-statement-per-connection-size: 20
      # 配置监控统计拦截的filters（stat:监控统计、wall:防火墙）
      filters: stat,wall
      # 通过connectProperties属性来打开mergeSql功能；慢SQL记录
      connection-properties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000
      # 合并多个DruidDataSource的监控数据
      use-global-data-source-stat: true

  # Redis配置
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}
    database: 0
    timeout: 3000ms
    lettuce:
      pool:
        max-active: 8
        max-wait: -1ms
        max-idle: 8
        min-idle: 0

# 邮件功能开关（配置邮箱后设置true）
mail:
  enable: ${MAIL_ENABLE:false}

# 用户验证码邮件模板
user:
  code:
    format: "您的验证码是：%s，有效期5分钟，请勿泄露给他人。"

# Spring Boot Actuator 配置
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when-authorized

# 本地文件存储配置
local:
  enable: true
  # 上传文件存储的本地路径（绝对路径）
  uploadUrl: ${LOCAL_UPLOAD_PATH:/app/resourceStorage/}
  # 文件访问的URL路径
  downloadUrl: ${LOCAL_DOWNLOAD_URL:http://localhost:8081/resourceStorage/}

# 存储类型：local-本地存储, qiniu-七牛云
store:
  type: ${STORE_TYPE:local}

#  datasource:
#    url: jdbc:mysql://${spring.datasource.host:localhost}:${spring.datasource.port:3306}/poetize?allowPublicKeyRetrieval=true&useSSL=false&useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai
#    type: com.alibaba.druid.pool.DruidDataSource
#    driver-class-name: com.mysql.cj.jdbc.Driver

# CORS配置（生产环境请配置实际域名）
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:https://yourdomain.com,https://www.yourdomain.com}