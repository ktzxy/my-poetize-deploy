(window.webpackJsonp=window.webpackJsonp||[]).push([["admin-apicache~d6bce6c5"],{4785:function(e,t,a){},acb0:function(e,t,a){"use strict";a.r(t);var s=a("1da1"),r=(a("e9c4"),a("96cf"),{name:"ApiCacheManagement",data:function(){return{loading:!1,overview:{cacheType:"MEMORY",totalKeys:0,categoryCount:{}},searchPattern:"",viewDialogVisible:!1,currentCache:{},currentCacheValue:"",cacheList:[],allCacheKeys:[]}},mounted:function(){this.loadOverview(),this.loadCacheKeys()},methods:{getStatsCount:function(){return this.overview.categoryCount&&this.overview.categoryCount.stats||0},getUserCount:function(){return this.overview.categoryCount&&this.overview.categoryCount.user||0},loadOverview:function(){var e=this;return Object(s.a)(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get(e.$constant.baseURL+"/admin/cache/overview",{},!0);case 3:200===(a=t.sent).code&&a.data&&(e.overview=a.data),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),e.$message.error("åŠ è½½ç¼“å­˜æ¦‚è§ˆå¤±è´¥");case 11:case"end":return t.stop()}},t,null,[[0,7]])}))()},loadCacheKeys:function(){var e=this;return Object(s.a)(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.$http.get(e.$constant.baseURL+"/admin/cache/keys",{pattern:e.searchPattern},!0);case 4:200===(a=t.sent).code&&a.data&&(e.allCacheKeys=a.data,e.cacheList=a.data),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),e.$message.error("åŠ è½½ç¼“å­˜é”®å¤±è´¥");case 12:return t.prev=12,e.loading=!1,t.finish(12);case 15:case"end":return t.stop()}},t,null,[[1,8,12,15]])}))()},searchKeys:function(){this.loadCacheKeys()},viewCache:function(e){var t=this;return Object(s.a)(regeneratorRuntime.mark(function a(){var s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.get(t.$constant.baseURL+"/admin/cache/get/".concat(encodeURIComponent(e.key)),{},!0);case 3:200===(s=a.sent).code?(t.currentCache=e,t.currentCacheValue=JSON.stringify(s.data,null,2),t.viewDialogVisible=!0):t.$message.warning(s.message||"ç¼“å­˜ä¸å­˜åœ¨æˆ–å·²è¿‡æœŸ"),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),t.$message.error("æŸ¥çœ‹ç¼“å­˜å¤±è´¥");case 11:case"end":return a.stop()}},a,null,[[0,7]])}))()},deleteCache:function(e){var t=this;this.$confirm('ç¡®è®¤åˆ é™¤ç¼“å­˜é”® "'.concat(e.key,'" ï¼Ÿ'),"æç¤º",{type:"warning"}).then(Object(s.a)(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.delete(t.$constant.baseURL+"/admin/cache/remove/".concat(encodeURIComponent(e.key)),{},!0);case 3:200===a.sent.code&&(t.$message.success("ç¼“å­˜å·²åˆ é™¤"),t.loadOverview(),t.loadCacheKeys()),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),t.$message.error("åˆ é™¤ç¼“å­˜å¤±è´¥");case 11:case"end":return a.stop()}},a,null,[[0,7]])}))).catch(function(){})},deleteCurrentCache:function(){this.viewDialogVisible=!1,this.deleteCache(this.currentCache)},clearStatisticsCache:function(){var e=this;this.$confirm("ç¡®è®¤æ¸…é™¤æ‰€æœ‰ç»Ÿè®¡æ•°æ®ç¼“å­˜ï¼Ÿ","æç¤º",{type:"warning"}).then(Object(s.a)(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.delete(e.$constant.baseURL+"/admin/cache/clear/stats",{},!0);case 3:200===(a=t.sent).code&&(e.$message.success(a.data||"ç»Ÿè®¡ç¼“å­˜å·²æ¸…é™¤"),e.loadOverview(),e.loadCacheKeys()),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),e.$message.error("æ¸…é™¤ç»Ÿè®¡ç¼“å­˜å¤±è´¥");case 11:case"end":return t.stop()}},t,null,[[0,7]])}))).catch(function(){})},clearAll:function(){var e=this;this.$confirm("ç¡®è®¤æ¸…ç©ºæ‰€æœ‰ç¼“å­˜ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚","è­¦å‘Š",{type:"error"}).then(Object(s.a)(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.delete(e.$constant.baseURL+"/admin/cache/clear",{},!0);case 3:200===(a=t.sent).code&&(e.$message.success(a.data||"æ‰€æœ‰ç¼“å­˜å·²æ¸…ç©º"),e.loadOverview(),e.loadCacheKeys()),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),e.$message.error("æ¸…ç©ºç¼“å­˜å¤±è´¥");case 11:case"end":return t.stop()}},t,null,[[0,7]])}))).catch(function(){})},getCategoryName:function(e){return{user:"ç”¨æˆ·",article:"æ–‡ç« ",comment:"è¯„è®º",stats:"ç»Ÿè®¡",token:"ä»¤ç‰Œ",other:"å…¶ä»–"}[e]||e},getCategoryType:function(e){return{user:"success",article:"primary",comment:"warning",stats:"danger",token:"info",other:""}[e]||""}}}),c=r,n=(a("d9be"),a("2877")),i=Object(n.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-cache-container"},[a("el-tag",{staticClass:"my-tag",attrs:{effect:"dark"}},[a("i",{staticClass:"el-icon-lightning"}),e._v(" ç³»ç»Ÿç¼“å­˜ç®¡ç† ")]),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"stat-card"},[a("div",{staticClass:"stat-label"},[e._v("ç¼“å­˜ç±»å‹")]),a("div",{staticClass:"stat-value",style:{color:"REDIS"===e.overview.cacheType?"#67c23a":"#e6a23c"}},[e._v(" "+e._s(e.overview.cacheType||"MEMORY")+" ")]),a("div",{staticClass:"stat-sub"},[e._v(e._s("REDIS"===e.overview.cacheType?"Redisåˆ†å¸ƒå¼":"å†…å­˜ç¼“å­˜"))])])],1),a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"stat-card"},[a("div",{staticClass:"stat-label"},[e._v("ç¼“å­˜æ€»æ•°")]),a("div",{staticClass:"stat-value",staticStyle:{color:"#409eff"}},[e._v(e._s(e.overview.totalKeys||0))]),a("div",{staticClass:"stat-sub"},[e._v("ä¸ªç¼“å­˜é”®")])])],1),a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"stat-card"},[a("div",{staticClass:"stat-label"},[e._v("ç»Ÿè®¡ç¼“å­˜")]),a("div",{staticClass:"stat-value",staticStyle:{color:"#e6a23c"}},[e._v(e._s(e.getStatsCount()))]),a("div",{staticClass:"stat-sub"},[e._v("ç»Ÿè®¡æ•°æ®")])])],1),a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"stat-card"},[a("div",{staticClass:"stat-label"},[e._v("ç”¨æˆ·ç¼“å­˜")]),a("div",{staticClass:"stat-value",staticStyle:{color:"#f56c6c"}},[e._v(e._s(e.getUserCount()))]),a("div",{staticClass:"stat-sub"},[e._v("ç”¨æˆ·ä¼šè¯")])])],1)],1),a("el-card",{staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("ğŸ“Š ç¼“å­˜åˆ†ç±»ç»Ÿè®¡")])]),a("el-row",{attrs:{gutter:15}},e._l(e.overview.categoryCount,function(t,s){return a("el-col",{key:s,attrs:{span:4}},[a("div",{staticClass:"category-item"},[a("div",{staticClass:"category-label"},[e._v(e._s(e.getCategoryName(s)))]),a("div",{staticClass:"category-value"},[e._v(e._s(t))])])])}),1)],1),a("el-card",{staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("ğŸ“‹ ç¼“å­˜é”®åˆ—è¡¨ ("+e._s(e.cacheList.length)+")")]),a("div",[a("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"æœç´¢ç¼“å­˜é”®",size:"small"},on:{input:e.searchKeys},model:{value:e.searchPattern,callback:function(t){e.searchPattern=t},expression:"searchPattern"}},[a("i",{staticClass:"el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),a("el-button",{attrs:{type:"success",size:"small"},on:{click:e.loadCacheKeys}},[a("i",{staticClass:"el-icon-refresh"}),e._v(" åˆ·æ–° ")]),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.clearStatisticsCache}},[a("i",{staticClass:"el-icon-delete"}),e._v(" æ¸…é™¤ç»Ÿè®¡ç¼“å­˜ ")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.clearAll}},[a("i",{staticClass:"el-icon-delete"}),e._v(" æ¸…ç©ºå…¨éƒ¨ ")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.cacheList}},[a("el-table-column",{attrs:{prop:"key",label:"ç¼“å­˜é”®","min-width":"250"}}),a("el-table-column",{attrs:{label:"åˆ†ç±»",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"small",type:e.getCategoryType(t.row.category)}},[e._v(e._s(e.getCategoryName(t.row.category)))])]}}])}),a("el-table-column",{attrs:{label:"çŠ¶æ€",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.exists?"success":"info",size:"small"}},[e._v(" "+e._s(t.row.exists?"å­˜åœ¨":"å·²è¿‡æœŸ")+" ")])]}}])}),a("el-table-column",{attrs:{label:"æ“ä½œ",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.viewCache(t.row)}}},[e._v("æŸ¥çœ‹")]),a("el-button",{staticStyle:{color:"#f56c6c"},attrs:{size:"mini",type:"text"},on:{click:function(a){return e.deleteCache(t.row)}}},[e._v("åˆ é™¤")])]}}])})],1)],1),a("el-dialog",{attrs:{title:"ç¼“å­˜å†…å®¹",visible:e.viewDialogVisible,width:"60%"},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("strong",[e._v("ç¼“å­˜é”®ï¼š")]),e._v(" "+e._s(e.currentCache.key)+" ")]),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("strong",[e._v("åˆ†ç±»ï¼š")]),a("el-tag",{attrs:{size:"small",type:e.getCategoryType(e.currentCache.category)}},[e._v(e._s(e.getCategoryName(e.currentCache.category)))])],1),a("el-divider"),a("pre",{staticStyle:{"max-height":"400px",overflow:"auto",background:"#f5f5f5",padding:"15px","border-radius":"4px"}},[e._v(e._s(e.currentCacheValue))]),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.viewDialogVisible=!1}}},[e._v("å…³é—­")]),a("el-button",{attrs:{type:"danger"},on:{click:e.deleteCurrentCache}},[e._v("åˆ é™¤æ­¤ç¼“å­˜")])],1)],1)],1)},[],!1,null,"4537cb8c",null);t.default=i.exports},d9be:function(e,t,a){"use strict";a("4785")}}]);