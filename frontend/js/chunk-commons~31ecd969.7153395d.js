(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-commons~31ecd969"],{"07ac":function(e,t,a){var r=a("23e7"),n=a("6f53").values;r({target:"Object",stat:!0},{values:function(e){return n(e)}})},2909:function(e,t,a){"use strict";a.d(t,"a",function(){return s});var r=a("6b75");a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");var n=a("06c5");function s(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Object(n.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}a("d9e2")},6034:function(e,t,a){"use strict";a.r(t);function r(e){var t=new XMLHttpRequest,a=e.action;t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var r=new FormData;e.data&&Object.keys(e.data).forEach(function(t){r.append(t,e.data[t])}),r.append(e.filename,e.file,e.file.name),t.onerror=function(t){e.onError(t)},t.onload=function(){if(t.status<200||t.status>=300)return e.onError(function(e,t,a){var r;return r=a.response?"".concat(a.response.error||a.response):a.responseText?"".concat(a.responseText):"fail to ".concat(e," ").concat(a.status),new Error(r)}(a,0,t));e.onSuccess(function(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}(t))},t.open("post",a,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var n=e.headers||{};for(var s in n)n.hasOwnProperty(s)&&null!==n[s]&&t.setRequestHeader(s,n[s]);return t.send(r),t}a("a9e3"),a("b0c0"),a("ac1f"),a("5319"),a("d3b7"),a("a434"),a("99af"),a("d9e2"),a("159b"),a("b64b");var n={props:{isAdmin:{type:Boolean,default:!1},prefix:{type:String,default:""},listType:{type:String,default:"picture"},storeType:{type:String,default:""},accept:{type:String,default:"image/*"},maxSize:{type:Number,default:5},maxNumber:{type:Number,default:5}},data:function(){return{actualStoreType:localStorage.getItem("defaultStoreType")||"local"}},computed:{},watch:{storeType:function(e){this.actualStoreType=e||localStorage.getItem("defaultStoreType")||"local"}},created:function(){},mounted:function(){},methods:{submitUpload:function(){this.$refs.upload.submit()},customUpload:function(e){var t="";-1!==e.file.name.lastIndexOf(".")&&(t=e.file.name.substring(e.file.name.lastIndexOf(".")));var a;a=this.isAdmin&&this.$store.state.currentAdmin&&this.$store.state.currentAdmin.username?this.$store.state.currentAdmin.username.replace(/[^a-zA-Z]/g,"")+this.$store.state.currentAdmin.id:!this.isAdmin&&this.$store.state.currentUser&&this.$store.state.currentUser.username?this.$store.state.currentUser.username.replace(/[^a-zA-Z]/g,"")+this.$store.state.currentUser.id:"user"+Math.floor(1e5*Math.random());var n=this.prefix+"/"+a+(new Date).getTime()+Math.floor(1e3*Math.random())+t;if("local"===this.actualStoreType){var s=new FormData;return s.append("file",e.file),s.append("originalName",e.file.name),s.append("key",n),s.append("relativePath",n),s.append("type",this.prefix),s.append("storeType",this.actualStoreType),this.$http.upload(this.$constant.baseURL+"/resource/upload",s,this.isAdmin,e).then(function(e){return e}).catch(function(e){throw e})}if("qiniu"===this.actualStoreType){var o=new XMLHttpRequest;o.open("get",this.$constant.baseURL+"/qiniu/getUpToken?key="+n,!1),this.isAdmin?o.setRequestHeader("Authorization",localStorage.getItem("adminToken")):o.setRequestHeader("Authorization",localStorage.getItem("userToken"));try{o.send();var i=JSON.parse(o.responseText);return null!==i&&i.hasOwnProperty("code")&&200===i.code?(e.data={token:i.data,key:n},e.action=this.$store.state.sysConfig.qiniuUrl,r(e)):null!==i&&i.hasOwnProperty("code")&&200!==i.code?Promise.reject(i.message):Promise.reject("服务异常！")}catch(e){return Promise.reject(e.message)}}},handleSuccess:function(e,t,a){var r;"local"===this.actualStoreType?r=e.data:"qiniu"===this.actualStoreType&&(r=this.$store.state.sysConfig["qiniu.downloadUrl"]+e.key,this.$common.saveResource(this,this.prefix,r,t.size,t.raw.type,t.name,"qiniu",this.isAdmin)),this.$message({message:"上传成功！",type:"success"}),this.$emit("addPicture",r)},handleError:function(e,t,a){this.$message({message:e,type:"error"})},beforeUpload:function(e){},handleRemove:function(e,t){},handleChange:function(e,t){var a=!1;e.size>1024*this.maxSize*1024&&(this.$message({message:"图片最大为"+this.maxSize+"M！",type:"warning"}),a=!0),a&&t.splice(t.size-1,1)}}},s=n,o=a("2877"),i=Object(o.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{multiple:"",drag:"",action:"","on-change":e.handleChange,"before-upload":e.beforeUpload,"on-success":e.handleSuccess,"on-error":e.handleError,"on-remove":e.handleRemove,"http-request":e.customUpload,"list-type":e.listType,accept:e.accept,limit:e.maxNumber,"auto-upload":!1}},[a("div",{staticClass:"el-upload__text"},[a("svg",{attrs:{viewBox:"0 0 1024 1024",width:"40",height:"40"}},[a("path",{attrs:{d:"M666.2656 629.4528l-113.7664-112.4864c-20.7872-20.5824-54.3232-20.5312-75.1104 0.1024l-113.3056 112.4864c-20.8896 20.736-21.0432 54.528-0.256 75.4688 20.736 20.8896 54.528 21.0432 75.4688 0.256l22.6304-22.4256v189.5936c0 29.44 23.9104 53.3504 53.3504 53.3504s53.3504-23.9104 53.3504-53.3504v-189.5424l22.6816 22.4256a53.1456 53.1456 0 0 0 37.5296 15.4112c13.7728 0 27.4944-5.2736 37.9392-15.8208 20.6336-20.9408 20.4288-54.7328-0.512-75.4688z",fill:"#FFE37B"}}),a("path",{attrs:{d:"M820.992 469.504h-5.376c-3.072-163.328-136.3456-294.8096-300.4416-294.8096S217.856 306.1248 214.784 469.504H209.408c-100.7104 0-182.3744 81.664-182.3744 182.3744s81.664 182.3744 182.3744 182.3744h209.7664V761.856c-30.208 5.5808-62.464-3.3792-85.6576-26.7264-37.3248-37.5808-37.0688-98.5088 0.512-135.7824l113.3056-112.4864c37.2224-36.9664 97.8432-37.0176 135.168-0.1536l113.7664 112.4864c18.2272 18.0224 28.3648 42.0864 28.5184 67.7376 0.1536 25.6512-9.728 49.8176-27.7504 68.0448a95.40096 95.40096 0 0 1-68.3008 28.5184c-5.9392 0-11.776-0.512-17.5104-1.5872v72.3456h209.7664c100.7104 0 182.3744-81.664 182.3744-182.3744S921.7024 469.504 820.992 469.504z",fill:"#8C7BFD"}})]),a("div",[e._v("拖拽上传 / 点击上传")])]),"picture"===e.listType?[a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 一次最多上传"+e._s(e.maxNumber)+"张图片，且每张图片不超过"+e._s(e.maxSize)+"M！ ")])]:[a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 一次最多上传"+e._s(e.maxNumber)+"个文件，且每个文件不超过"+e._s(e.maxSize)+"M！ ")])]],2),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-button",{staticStyle:{"font-size":"12px"},attrs:{type:"success"},on:{click:e.submitUpload}},[e._v(" 上传 ")])],1)],1)},[],!1,null,"a3d889f6",null);t.default=i.exports},"81d5":function(e,t,a){"use strict";var r=a("7b0b"),n=a("23cb"),s=a("07fa");e.exports=function(e){for(var t=r(this),a=s(t),o=arguments.length,i=n(o>1?arguments[1]:void 0,a),c=o>2?arguments[2]:void 0,l=void 0===c?a:n(c,a);l>i;)t[i++]=e;return t}},a434:function(e,t,a){"use strict";var r=a("23e7"),n=a("da84"),s=a("23cb"),o=a("5926"),i=a("07fa"),c=a("7b0b"),l=a("65f0"),u=a("8418"),d=a("1dde")("splice"),p=n.TypeError,f=Math.max,h=Math.min;r({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var a,r,n,d,m,y,v=c(this),g=i(v),b=s(e,g),S=arguments.length;if(0===S?a=r=0:1===S?(a=0,r=g-b):(a=S-2,r=h(f(o(t),0),g-b)),g+a-r>9007199254740991)throw p("Maximum allowed length exceeded");for(n=l(v,r),d=0;d<r;d++)(m=b+d)in v&&u(n,d,v[m]);if(n.length=r,a<r){for(d=b;d<g-r;d++)y=d+a,(m=d+r)in v?v[y]=v[m]:delete v[y];for(d=g;d>g-r+a;d--)delete v[d-1]}else if(a>r)for(d=g-r;d>b;d--)y=d+a-1,(m=d+r-1)in v?v[y]=v[m]:delete v[y];for(d=0;d<a;d++)v[d+b]=arguments[d+2];return v.length=g-r+a,n}})},c740:function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").findIndex,s=a("44d2"),o="findIndex",i=!0;o in[]&&Array(1)[o](function(){i=!1}),r({target:"Array",proto:!0,forced:i},{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},cb29:function(e,t,a){var r=a("23e7"),n=a("81d5"),s=a("44d2");r({target:"Array",proto:!0},{fill:n}),s("fill")}}]);