(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e452c896"],{"9b4a":function(t,a,e){"use strict";e.r(a);var s=e("5530"),n=e("2909"),o=(e("4de4"),e("d3b7"),e("caad"),e("2532"),e("4e82"),e("fb6a"),e("159b"),e("99af"),e("d81d"),{name:"TagCloud",data:function(){return{tags:[],radius:120,angleX:0,angleY:0,mouseX:0,mouseY:0,isHovering:!1,hoveredIndex:-1,autoRotate:!0,animationFrame:null,colors:["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7DC6F","#BB8FCE","#85C1E2","#F8B739","#52B788","#F06292","#64B5F6","#FFB74D","#81C784","#E57373","#9575CD","#4DD0E1","#FFD54F","#A1887F","#90A4AE","#FF8A65","#4DB6AC","#7986CB","#AED581","#FFB300","#EC407A","#5C6BC0","#26A69A","#FF7043","#AB47BC"],viewMode:"3d",sortMode:"hot",searchKeyword:"",showAnalysisDialog:!1,relationsData:[],trendsData:[]}},computed:{filteredTags:function(){var t=this,a=this.tags;return this.searchKeyword&&(a=a.filter(function(a){return a.labelName.toLowerCase().includes(t.searchKeyword.toLowerCase())})),a=Object(n.a)(a).sort(function(a,e){switch(t.sortMode){case"hot":return e.countOfLabel-a.countOfLabel;case"name":return a.labelName.localeCompare(e.labelName,"zh-CN");case"time":return(e.id||0)-(a.id||0);default:return 0}}),a},totalArticles:function(){return this.tags.reduce(function(t,a){return t+(a.countOfLabel||0)},0)},viewModeIcon:function(){switch(this.viewMode){case"3d":default:return"el-icon-magic-stick";case"2d":return"el-icon-picture-outline";case"heatmap":return"el-icon-data-board"}},hotTags:function(){return Object(n.a)(this.tags).sort(function(t,a){return a.countOfLabel-t.countOfLabel}).slice(0,10)},tagRelations:function(){return this.relationsData},trendingTags:function(){return this.trendsData}},mounted:function(){this.getAllTags(),this.getTagAnalysis(),this.startAutoRotate()},beforeDestroy:function(){this.stopAutoRotate()},methods:{getAllTags:function(){var t=this,a=this.$store.state.sortInfo;if(!this.$common.isEmpty(a)){var e=[];a.forEach(function(a){t.$common.isEmpty(a.labels)||(e=e.concat(a.labels))});var o=e.map(function(t){return t.countOfLabel}),i=Math.min.apply(Math,Object(n.a)(o)),r=Math.max.apply(Math,Object(n.a)(o));this.tags=e.map(function(a,n){var o=i===r?18:12+(a.countOfLabel-i)/(r-i)*16,c=Math.acos(2*n/e.length-1),l=Math.sqrt(e.length*Math.PI)*c;return Object(s.a)(Object(s.a)({},a),{},{size:Math.round(o),x:t.radius*Math.cos(l)*Math.sin(c),y:t.radius*Math.sin(l)*Math.sin(c),z:t.radius*Math.cos(c),alpha:1,color:t.colors[n%t.colors.length]})})}},getTagStyle:function(t){var a=this.tags[t];if(!a)return{};var e=a.x,s=a.y*Math.cos(this.angleX)-a.z*Math.sin(this.angleX),n=a.y*Math.sin(this.angleX)+a.z*Math.cos(this.angleX),o=e*Math.cos(this.angleY)-n*Math.sin(this.angleY),i=s,r=e*Math.sin(this.angleY)+n*Math.cos(this.angleY),c=(this.radius+r)/(2*this.radius),l=.5*c+.5,d=this.hoveredIndex===t;return{left:o+this.radius+"px",top:i+this.radius+"px",opacity:l,transform:"scale(".concat(c*(d?1.3:1),")"),zIndex:Math.round(r+this.radius),color:a.color,fontWeight:d?"bold":"normal",textShadow:d?"0 0 10px ".concat(a.color):"none"}},handleMouseMove:function(t){if(this.$refs.tagCloud){var a=this.$refs.tagCloud.getBoundingClientRect();this.mouseX=t.clientX-a.left-this.radius,this.mouseY=t.clientY-a.top-this.radius,this.autoRotate=!1,this.isHovering=!0,this.angleY+=1e-4*this.mouseX,this.angleX+=1e-4*this.mouseY}},handleMouseLeave:function(){this.isHovering=!1,this.autoRotate=!0},handleTagHover:function(t){this.hoveredIndex=t},handleTagLeave:function(){this.hoveredIndex=-1},startAutoRotate:function(){var t=this;!function a(){t.autoRotate&&(t.angleY+=.005,t.angleX+=.002),t.animationFrame=requestAnimationFrame(a)}()},stopAutoRotate:function(){this.animationFrame&&cancelAnimationFrame(this.animationFrame)},goToTag:function(t){this.$router.push({path:"/sort",query:{sortId:t.sortId,labelId:t.id}})},handleViewMode:function(t){var a=this;this.viewMode=t,"3d"===t?this.$nextTick(function(){a.startAutoRotate()}):this.stopAutoRotate()},handleSortMode:function(t){this.sortMode=t},handleSearch:function(){"3d"===this.viewMode&&this.repositionTags()},repositionTags:function(){var t=this,a=this.filteredTags;a.forEach(function(e,s){var n=Math.acos(2*s/a.length-1),o=Math.sqrt(a.length*Math.PI)*n;e.x=t.radius*Math.cos(o)*Math.sin(n),e.y=t.radius*Math.sin(o)*Math.sin(n),e.z=t.radius*Math.cos(n)})},showTagAnalysis:function(){this.showAnalysisDialog=!0},getTagAnalysis:function(){var t=this;this.$http.get(this.$constant.baseURL+"/tag/cooccurrence").then(function(a){a&&a.data&&(t.relationsData=a.data)}).catch(function(a){t.relationsData=[]}),this.$http.get(this.$constant.baseURL+"/tag/trends").then(function(a){a&&a.data&&(t.trendsData=a.data.map(function(t){return{tagName:t.tagName,trend:t.trend,growthRate:t.growthRate}}))}).catch(function(a){t.trendsData=[]})},getTag2DStyle:function(t,a){return{fontSize:t.size+"px",color:t.color,fontWeight:500+Math.floor(t.countOfLabel/this.totalArticles*400)}},getHeatmapStyle:function(t){var a=Math.max.apply(Math,Object(n.a)(this.tags.map(function(t){return t.countOfLabel}))),e=t.countOfLabel/a;return{backgroundColor:this.getHeatColor(e),flex:t.countOfLabel}},getHeatColor:function(t){var a,e,s,n=[{percent:0,color:{r:68,g:138,b:255}},{percent:.5,color:{r:255,g:193,b:7}},{percent:1,color:{r:245,g:108,b:108}}];t<=.5?(a=n[0].color,e=n[1].color,s=2*t):(a=n[1].color,e=n[2].color,s=2*(t-.5));var o=Math.round(a.r+(e.r-a.r)*s),i=Math.round(a.g+(e.g-a.g)*s),r=Math.round(a.b+(e.b-a.b)*s);return"rgb(".concat(o,", ").concat(i,", ").concat(r,")")},getPercentage:function(t){var a=Math.max.apply(Math,Object(n.a)(this.tags.map(function(t){return t.countOfLabel})));return Math.round(t/a*100)},getProgressColor:function(t){var a=["#f56c6c","#e6a23c","#409eff","#67c23a","#909399"];return a[t%a.length]},getTrendType:function(t){switch(t){case"up":return"success";case"down":return"danger";default:return"info"}},getTrendIcon:function(t){switch(t){case"up":return"el-icon-top";case"down":return"el-icon-bottom";default:return"el-icon-minus"}}}}),i=o,r=(e("b65d"),e("2877")),c=Object(r.a)(i,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"tag-cloud-container shadow-box background-opacity wow",on:{mousemove:t.handleMouseMove,mouseleave:t.handleMouseLeave}},[e("div",{staticClass:"tag-cloud-header"},[t._m(0),e("div",{staticClass:"tag-cloud-controls"},[e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleViewMode}},[e("span",{staticClass:"control-btn"},[e("i",{class:t.viewModeIcon})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"3d"}},[t._v("ðŸŒ 3Dçƒä½“")]),e("el-dropdown-item",{attrs:{command:"2d"}},[t._v("ðŸ“Š 2Däº‘å›¾")]),e("el-dropdown-item",{attrs:{command:"heatmap"}},[t._v("ðŸ”¥ çƒ­åŠ›å›¾")])],1)],1),e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleSortMode}},[e("span",{staticClass:"control-btn"},[e("i",{staticClass:"el-icon-sort"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"hot"}},[t._v("ðŸ”¥ çƒ­åº¦æŽ’åº")]),e("el-dropdown-item",{attrs:{command:"name"}},[t._v("ðŸ”¤ åç§°æŽ’åº")]),e("el-dropdown-item",{attrs:{command:"time"}},[t._v("â° æ—¶é—´æŽ’åº")])],1)],1),e("span",{staticClass:"control-btn",on:{click:t.showTagAnalysis}},[e("i",{staticClass:"el-icon-data-analysis"})])],1)]),e("div",{staticClass:"tag-search"},[e("el-input",{attrs:{placeholder:"æœç´¢æ ‡ç­¾...","prefix-icon":"el-icon-search",size:"small",clearable:""},on:{input:t.handleSearch},model:{value:t.searchKeyword,callback:function(a){t.searchKeyword=a},expression:"searchKeyword"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"3d"===t.viewMode,expression:"viewMode === '3d'"}],ref:"tagCloud",staticClass:"tag-cloud-wrapper"},t._l(t.filteredTags,function(a,s){return e("div",{key:s,staticClass:"tag-item",style:t.getTagStyle(s),on:{click:function(e){return t.goToTag(a)},mouseenter:function(a){return t.handleTagHover(s)},mouseleave:t.handleTagLeave}},[e("span",{staticClass:"tag-text",style:{fontSize:a.size+"px"}},[t._v(" "+t._s(a.labelName)+" ")]),e("span",{staticClass:"tag-count"},[t._v("("+t._s(a.countOfLabel)+")")])])}),0),e("div",{directives:[{name:"show",rawName:"v-show",value:"2d"===t.viewMode,expression:"viewMode === '2d'"}],staticClass:"tag-cloud-2d"},t._l(t.filteredTags,function(a,s){return e("div",{key:s,staticClass:"tag-item-2d",style:t.getTag2DStyle(a,s),on:{click:function(e){return t.goToTag(a)}}},[e("span",[t._v(t._s(a.labelName))]),e("span",{staticClass:"tag-count-2d"},[t._v("("+t._s(a.countOfLabel)+")")])])}),0),e("div",{directives:[{name:"show",rawName:"v-show",value:"heatmap"===t.viewMode,expression:"viewMode === 'heatmap'"}],staticClass:"tag-heatmap"},t._l(t.filteredTags,function(a,s){return e("div",{key:s,staticClass:"heatmap-item",style:t.getHeatmapStyle(a),on:{click:function(e){return t.goToTag(a)}}},[e("div",{staticClass:"heatmap-name"},[t._v(t._s(a.labelName))]),e("div",{staticClass:"heatmap-value"},[t._v(t._s(a.countOfLabel))])])}),0),e("div",{staticClass:"tag-stats"},[e("div",{staticClass:"stat-item"},[e("i",{staticClass:"el-icon-collection-tag"}),e("span",[t._v(t._s(t.tags.length)+" ä¸ªæ ‡ç­¾")])]),e("div",{staticClass:"stat-item"},[e("i",{staticClass:"el-icon-document"}),e("span",[t._v(t._s(t.totalArticles)+" ç¯‡æ–‡ç« ")])])]),e("el-dialog",{attrs:{title:"ðŸ“Š æ ‡ç­¾åˆ†æž",visible:t.showAnalysisDialog,width:"700px","append-to-body":!0},on:{"update:visible":function(a){t.showAnalysisDialog=a}}},[e("div",{staticClass:"tag-analysis"},[e("div",{staticClass:"analysis-section"},[e("h3",[t._v("ðŸ”¥ çƒ­é—¨æ ‡ç­¾ TOP 10")]),e("div",{staticClass:"hot-tags-list"},t._l(t.hotTags,function(a,s){return e("div",{key:s,staticClass:"hot-tag-item"},[e("span",{staticClass:"rank"},[t._v(t._s(s+1))]),e("span",{staticClass:"tag-name"},[t._v(t._s(a.labelName))]),e("el-progress",{attrs:{percentage:t.getPercentage(a.countOfLabel),color:t.getProgressColor(s)}}),e("span",{staticClass:"tag-value"},[t._v(t._s(a.countOfLabel))])],1)}),0)]),e("div",{staticClass:"analysis-section"},[e("h3",[t._v("ðŸ”— æ ‡ç­¾å…³è”åˆ†æž")]),e("div",{staticClass:"tag-relation"},t._l(t.tagRelations,function(a,s){return e("div",{key:s,staticClass:"relation-item"},[e("span",{staticClass:"relation-tags"},[e("el-tag",{attrs:{size:"small",type:"primary"}},[t._v(t._s(a.tag1))]),e("i",{staticClass:"el-icon-connection"}),e("el-tag",{attrs:{size:"small",type:"success"}},[t._v(t._s(a.tag2))])],1),e("span",{staticClass:"relation-count"},[t._v("å…±çŽ° "+t._s(a.count)+" æ¬¡")])])}),0)]),e("div",{staticClass:"analysis-section"},[e("h3",[t._v("ðŸ“ˆ æ ‡ç­¾è¶‹åŠ¿")]),e("div",{staticClass:"tag-trend"},t._l(t.trendingTags,function(a,s){return e("el-tag",{key:s,attrs:{type:t.getTrendType(a.trend),size:"medium",effect:"dark"}},[t._v(" "+t._s(a.labelName)+" "),e("i",{class:t.getTrendIcon(a.trend)})])}),1)])])])],1)},[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"tag-cloud-title"},[e("span",[t._v("ðŸ·ï¸ æ™ºèƒ½æ ‡ç­¾äº‘")])])}],!1,null,"0fe6cf44",null);a.default=c.exports},a0a7:function(t,a,e){},b65d:function(t,a,e){"use strict";e("a0a7")}}]);