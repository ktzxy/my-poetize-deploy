(window.webpackJsonp=window.webpackJsonp||[]).push([["app~748942c6"],{0:function(e,t){},"034f":function(e,t,a){"use strict";a("85ec")},1:function(e,t){},"17ec":function(e,t,a){},2:function(e,t,a){e.exports=a("56d7")},"3dfd":function(e,t,a){"use strict";var i=(a("b64b"),a("d3b7"),a("3ca3"),a("ddb0"),a("99af"),a("d9e2"),a("b0c0"),a("e9c4"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"settings-menu"},[a("el-popover",{attrs:{placement:"top-end",width:"400",trigger:"click"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticClass:"settings-panel"},[a("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"ğŸ¨ ä¸»é¢˜",name:"theme"}},[a("div",{staticClass:"theme-settings"},[a("div",{staticClass:"settings-section"},[a("h4",[e._v("é¢„è®¾ä¸»é¢˜")]),a("div",{staticClass:"theme-grid"},e._l(e.presetThemes,function(t){return a("div",{key:t.key,staticClass:"theme-card",class:{active:e.currentTheme===t.key},on:{click:function(a){return e.selectTheme(t.key)}}},[a("div",{staticClass:"theme-color",style:{background:t.color}}),a("span",{staticClass:"theme-label"},[e._v(e._s(t.name))]),e.currentTheme===t.key?a("i",{staticClass:"el-icon-check"}):e._e()])}),0)]),a("el-divider"),a("div",{staticClass:"settings-section"},[a("h4",[e._v("å¿«é€Ÿè®¾ç½®")]),a("div",{staticClass:"quick-settings"},[a("span",[e._v("æ·±è‰²æ¨¡å¼")]),a("el-switch",{on:{change:e.toggleDarkMode},model:{value:e.isDarkMode,callback:function(t){e.isDarkMode=t},expression:"isDarkMode"}})],1),a("div",{staticClass:"quick-settings"},[a("span",[e._v("æŠ¤çœ¼æ¨¡å¼")]),a("el-switch",{on:{change:e.toggleEyeMode},model:{value:e.isEyeMode,callback:function(t){e.isEyeMode=t},expression:"isEyeMode"}})],1),a("div",{staticClass:"quick-settings"},[a("span",[e._v("è‡ªåŠ¨åˆ‡æ¢")]),a("el-switch",{on:{change:e.toggleAutoSwitch},model:{value:e.autoSwitchTheme,callback:function(t){e.autoSwitchTheme=t},expression:"autoSwitchTheme"}})],1)]),a("el-divider"),a("div",{staticClass:"settings-section"},[a("h4",[e._v("èŠ‚æ—¥ä¸»é¢˜")]),a("div",{staticClass:"quick-settings"},[a("span",[e._v("å¯ç”¨èŠ‚æ—¥ä¸»é¢˜")]),a("el-switch",{on:{change:e.toggleHolidayTheme},model:{value:e.enableHolidayTheme,callback:function(t){e.enableHolidayTheme=t},expression:"enableHolidayTheme"}})],1),e.currentHoliday?a("p",{staticClass:"holiday-info"},[e._v(" ğŸ‰ å½“å‰èŠ‚æ—¥ï¼š"+e._s(e.currentHoliday.name)+" ")]):e._e()]),a("el-divider"),a("div",{staticClass:"settings-section"},[a("el-button-group",[a("el-button",{attrs:{size:"small",icon:"el-icon-download"},on:{click:e.exportTheme}},[e._v(" å¯¼å‡º ")]),a("el-button",{attrs:{size:"small",icon:"el-icon-upload2"},on:{click:e.showImportDialog}},[e._v(" å¯¼å…¥ ")]),a("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:e.resetTheme}},[e._v(" é‡ç½® ")])],1)],1)],1)]),a("el-tab-pane",{attrs:{label:"ğŸ‘ï¸ æ˜¾ç¤º",name:"display"}},[a("div",{staticClass:"display-settings"},[a("div",{staticClass:"settings-section"},[a("h4",[e._v("å­—ä½“å¤§å°")]),a("el-radio-group",{attrs:{size:"small"},on:{change:e.changeFontSize},model:{value:e.fontSizeLevel,callback:function(t){e.fontSizeLevel=t},expression:"fontSizeLevel"}},[a("el-radio-button",{attrs:{label:"small"}},[e._v("å°")]),a("el-radio-button",{attrs:{label:"medium"}},[e._v("ä¸­")]),a("el-radio-button",{attrs:{label:"large"}},[e._v("å¤§")]),a("el-radio-button",{attrs:{label:"xlarge"}},[e._v("ç‰¹å¤§")])],1)],1),a("el-divider"),a("div",{staticClass:"settings-section"},[a("h4",[e._v("è¡Œé—´è·")]),a("el-radio-group",{attrs:{size:"small"},on:{change:e.changeLineHeight},model:{value:e.lineHeightLevel,callback:function(t){e.lineHeightLevel=t},expression:"lineHeightLevel"}},[a("el-radio-button",{attrs:{label:"1.5"}},[e._v("ç´§å‡‘")]),a("el-radio-button",{attrs:{label:"1.8"}},[e._v("é€‚ä¸­")]),a("el-radio-button",{attrs:{label:"2.0"}},[e._v("èˆ’é€‚")]),a("el-radio-button",{attrs:{label:"2.5"}},[e._v("å®½æ¾")])],1)],1),a("el-divider"),a("div",{staticClass:"settings-section"},[a("h4",[e._v("é¡µé¢ç‰¹æ•ˆ")]),a("div",{staticClass:"quick-settings"},[a("span",[e._v("é¡µé¢åŠ¨ç”»")]),a("el-switch",{on:{change:e.toggleAnimations},model:{value:e.enableAnimations,callback:function(t){e.enableAnimations=t},expression:"enableAnimations"}})],1),a("div",{staticClass:"quick-settings"},[a("span",[e._v("ç²’å­èƒŒæ™¯")]),a("el-switch",{on:{change:e.toggleParticles},model:{value:e.enableParticles,callback:function(t){e.enableParticles=t},expression:"enableParticles"}})],1)])],1)]),a("el-tab-pane",{attrs:{label:"âš™ï¸ å…¶ä»–",name:"other"}},[a("div",{staticClass:"other-settings"},[a("div",{staticClass:"settings-section"},[a("h4",[e._v("èƒŒæ™¯ç‰¹æ•ˆ")]),a("div",{staticClass:"quick-settings"},[a("span",[e._v("æ˜¾ç¤ºèƒŒæ™¯")]),a("el-switch",{on:{change:e.toggleBackground},model:{value:e.enableBackground,callback:function(t){e.enableBackground=t},expression:"enableBackground"}})],1),e.enableBackground?a("div",{staticClass:"quick-settings"},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"é€‰æ‹©èƒŒæ™¯ç±»å‹",size:"small"},on:{change:e.changeBackgroundType},model:{value:e.backgroundType,callback:function(t){e.backgroundType=t},expression:"backgroundType"}},[a("el-option",{attrs:{label:"æ— ",value:"none"}}),a("el-option",{attrs:{label:"âœ¨ ç²’å­",value:"particle"}}),a("el-option",{attrs:{label:"ğŸŒ¸ æ¨±èŠ±",value:"sakura"}}),a("el-option",{attrs:{label:"â˜„ï¸ æµæ˜Ÿ",value:"meteor"}})],1)],1):e._e(),e.enableBackground&&"none"!==e.backgroundType?a("div",{staticClass:"quick-settings"},[a("span",[e._v("é€æ˜åº¦")]),a("el-slider",{staticStyle:{width:"120px","margin-left":"10px"},attrs:{min:0,max:100,step:5},on:{change:e.changeBackgroundOpacity},model:{value:e.backgroundOpacity,callback:function(t){e.backgroundOpacity=t},expression:"backgroundOpacity"}}),a("span",{staticClass:"size-preview"},[e._v(e._s(e.backgroundOpacity)+"%")])],1):e._e()]),a("el-divider"),a("div",{staticClass:"settings-section"},[a("h4",[e._v("é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ")]),a("div",{staticClass:"quick-settings"},[a("span",[e._v("å¯ç”¨ç‰¹æ•ˆ")]),a("el-switch",{on:{change:e.toggleMouseEffect},model:{value:e.enableMouseEffect,callback:function(t){e.enableMouseEffect=t},expression:"enableMouseEffect"}})],1)]),a("el-divider"),a("div",{staticClass:"settings-section"},[a("h4",[e._v("Live2Dçœ‹æ¿å¨˜")]),a("div",{staticClass:"quick-settings"},[a("span",[e._v("å¯ç”¨çœ‹æ¿å¨˜")]),a("el-switch",{on:{change:e.toggleLive2d},model:{value:e.enableLive2d,callback:function(t){e.enableLive2d=t},expression:"enableLive2d"}})],1)]),a("el-divider"),a("div",{staticClass:"settings-section"},[a("h4",[e._v("éŸ³ä¹æ’­æ”¾å™¨")]),a("div",{staticClass:"quick-settings"},[a("span",[e._v("å¯ç”¨éŸ³ä¹")]),a("el-switch",{on:{change:e.toggleMusic},model:{value:e.enableMusic,callback:function(t){e.enableMusic=t},expression:"enableMusic"}})],1)]),a("el-divider"),a("div",{staticClass:"settings-section"},[a("h4",[e._v("è§¦æ‘¸åé¦ˆï¼ˆç§»åŠ¨ç«¯ï¼‰")]),a("div",{staticClass:"quick-settings"},[a("span",[e._v("å¯ç”¨åé¦ˆ")]),a("el-switch",{on:{change:e.toggleTouchFeedback},model:{value:e.enableTouchFeedback,callback:function(t){e.enableTouchFeedback=t},expression:"enableTouchFeedback"}})],1)]),a("el-divider"),a("div",{staticClass:"settings-section"},[a("h4",[e._v("ç¼“å­˜ç®¡ç†")]),a("el-button",{staticStyle:{width:"100%"},attrs:{size:"small",icon:"el-icon-delete"},on:{click:e.clearCache}},[e._v(" æ¸…ç©ºæœ¬åœ°ç¼“å­˜ ")])],1)],1)])],1)],1),a("el-button",{staticClass:"settings-trigger",attrs:{slot:"reference",circle:"",icon:"el-icon-setting",title:"è®¾ç½®èœå•"},slot:"reference"})],1),a("el-dialog",{attrs:{title:"å¯¼å…¥ä¸»é¢˜",visible:e.importDialogVisible,width:"500px"},on:{"update:visible":function(t){e.importDialogVisible=t}}},[a("el-input",{attrs:{type:"textarea",rows:10,placeholder:"ç²˜è´´ä¸»é¢˜JSONé…ç½®..."},model:{value:e.importJson,callback:function(t){e.importJson=t},expression:"importJson"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.importDialogVisible=!1}}},[e._v("å–æ¶ˆ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.importTheme}},[e._v("å¯¼å…¥")])],1)],1)],1)}),n=a("1da1"),s=(a("96cf"),a("25f0"),a("7db0"),a("159b"),a("2b3d"),a("9861"),a("498a"),a("1cc7"),a("2007")),o={name:"EnhancedSettingsMenu",data:function(){return{visible:!1,activeTab:"theme",currentTheme:"default",isDarkMode:!1,isEyeMode:!1,autoSwitchTheme:!1,enableHolidayTheme:!0,currentHoliday:null,fontSizeLevel:"medium",lineHeightLevel:"1.8",enableAnimations:!0,enableParticles:!0,enableBackground:!0,backgroundType:"particle",backgroundOpacity:80,textScrollContent:"",enableMusic:!0,enableMouseEffect:!0,enableLive2d:!1,enableTouchFeedback:!0,sysConfig:{},importDialogVisible:!1,importJson:"",presetThemes:[{key:"default",name:"é»˜è®¤",color:"#667eea"},{key:"dark",name:"æš—é»‘",color:"#1a1a1a"},{key:"light",name:"æµ…è‰²",color:"#ffffff"},{key:"eye",name:"æŠ¤çœ¼",color:"#c7edcc"},{key:"ocean",name:"æµ·æ´‹",color:"#0077be"},{key:"sunset",name:"å¤•é˜³",color:"#ff6b6b"},{key:"forest",name:"æ£®æ—",color:"#52b788"},{key:"purple",name:"ç´«æ¢¦",color:"#9d4edd"}],holidayManager:null}},created:function(){this.holidayManager=new s.a,this.loadSettings(),this.updateHoliday(),this.loadSysConfig()},methods:{loadSettings:function(){var e=localStorage.getItem("poetize-settings");if(e){var t=JSON.parse(e);Object.assign(this,t)}},saveSettings:function(){var e={currentTheme:this.currentTheme,isDarkMode:this.isDarkMode,isEyeMode:this.isEyeMode,autoSwitchTheme:this.autoSwitchTheme,enableHolidayTheme:this.enableHolidayTheme,fontSizeLevel:this.fontSizeLevel,lineHeightLevel:this.lineHeightLevel,enableAnimations:this.enableAnimations,enableParticles:this.enableParticles,enableBackground:this.enableBackground,backgroundType:this.backgroundType,backgroundOpacity:this.backgroundOpacity,textScrollContent:this.textScrollContent,enableMusic:this.enableMusic,enableMouseEffect:this.enableMouseEffect,enableLive2d:this.enableLive2d,enableTouchFeedback:this.enableTouchFeedback};localStorage.setItem("poetize-settings",JSON.stringify(e)),localStorage.setItem("reading-font-size",this.fontSizeLevel),localStorage.setItem("reading-line-height",this.lineHeightLevel),localStorage.setItem("eye-protection",this.isEyeMode.toString()),localStorage.setItem("isDark",this.isDarkMode.toString())},selectTheme:function(e){this.currentTheme=e,this.applyTheme(e),"dark"===e?(this.isDarkMode=!0,this.$root.$emit("toggle-dark-mode",!0)):(this.isDarkMode=!1,this.$root.$emit("toggle-dark-mode",!1)),this.$message.success("å·²åˆ‡æ¢åˆ°".concat(this.presetThemes.find(function(t){return t.key===e}).name,"ä¸»é¢˜"))},applyTheme:function(e){var t={default:{primary:"#667eea",background:"#ffffff",text:"#333"},dark:{primary:"#667eea",background:"#1a1a1a",text:"#e0e0e0"},light:{primary:"#667eea",background:"#ffffff",text:"#000"},eye:{primary:"#52b788",background:"#c7edcc",text:"#333"},ocean:{primary:"#0077be",background:"#e3f2fd",text:"#01579b"},sunset:{primary:"#ff6b6b",background:"#fff5f5",text:"#c92a2a"},forest:{primary:"#52b788",background:"#f8fff8",text:"#1b5e20"},purple:{primary:"#9d4edd",background:"#f3e5f5",text:"#4a148c"}}[e];if(t){var a=document.documentElement;Object.keys(t).forEach(function(e){a.style.setProperty("--theme-".concat(e),t[e])})}this.saveSettings()},toggleDarkMode:function(e){this.isDarkMode=e;var t=e?"dark":"default";this.currentTheme=t,this.applyTheme(t),this.$root.$emit("toggle-dark-mode",e),this.saveSettings()},toggleEyeMode:function(e){this.isEyeMode=e,this.$root.$emit("toggle-eye-protection",e),this.saveSettings()},changeFontSize:function(e){this.fontSizeLevel=e,this.$root.$emit("change-font-size",e),this.saveSettings()},changeLineHeight:function(e){this.lineHeightLevel=e,this.$root.$emit("change-line-height",e),this.saveSettings()},toggleAnimations:function(e){this.enableAnimations=e,this.$message.info(e?"é¡µé¢åŠ¨ç”»å·²å¯ç”¨":"é¡µé¢åŠ¨ç”»å·²å…³é—­"),this.$root.$emit("toggle-animations",e),this.saveSettings()},toggleParticles:function(e){this.enableParticles=e,this.$message.info(e?"ç²’å­èƒŒæ™¯å·²å¯ç”¨":"ç²’å­èƒŒæ™¯å·²å…³é—­"),this.$root.$emit("toggle-particles",e),this.saveSettings()},toggleAutoSwitch:function(e){this.autoSwitchTheme=e,this.$message.info(e?"å·²å¯ç”¨ä¸»é¢˜è‡ªåŠ¨åˆ‡æ¢":"å·²å…³é—­ä¸»é¢˜è‡ªåŠ¨åˆ‡æ¢"),this.$root.$emit("toggle-auto-switch",e),this.saveSettings()},toggleHolidayTheme:function(e){if(this.enableHolidayTheme=e,e){var t=this.holidayManager.checkCurrentHoliday();t?(this.holidayManager.applyHolidayTheme(),this.$message.success("å·²å¯ç”¨".concat(t.name,"ä¸»é¢˜"))):this.$message.info("å½“å‰æ— ç‰¹æ®ŠèŠ‚æ—¥ä¸»é¢˜")}this.saveSettings()},updateHoliday:function(){this.currentHoliday=this.holidayManager.checkCurrentHoliday()},exportTheme:function(){var e=JSON.stringify({theme:this.currentTheme,settings:{fontSize:this.fontSize,lineHeight:this.lineHeight,isDarkMode:this.isDarkMode,isEyeMode:this.isEyeMode}},null,2),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),i=document.createElement("a");i.href=a,i.download="poetize-theme-".concat(Date.now(),".json"),i.click(),URL.revokeObjectURL(a),this.$message.success("ä¸»é¢˜å·²å¯¼å‡º")},showImportDialog:function(){this.importDialogVisible=!0,this.importJson=""},importTheme:function(){if(this.importJson.trim())try{var e=JSON.parse(this.importJson);e.theme&&this.selectTheme(e.theme),e.settings&&(Object.assign(this,e.settings),this.applyTheme(this.currentTheme)),this.importDialogVisible=!1,this.$message.success("ä¸»é¢˜å¯¼å…¥æˆåŠŸ")}catch(e){this.$message.error("ä¸»é¢˜å¯¼å…¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥JSONæ ¼å¼")}else this.$message.warning("è¯·è¾“å…¥ä¸»é¢˜é…ç½®")},resetTheme:function(){var e=this;this.$confirm("ç¡®å®šè¦é‡ç½®ä¸ºé»˜è®¤ä¸»é¢˜å—ï¼Ÿ","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(function(){e.selectTheme("default"),e.fontSize=14,e.lineHeight=1.5,e.isDarkMode=!1,e.isEyeMode=!1,e.saveSettings(),e.$message.success("å·²é‡ç½®ä¸ºé»˜è®¤è®¾ç½®")}).catch(function(){})},clearCache:function(){var e=this;this.$confirm("ç¡®å®šè¦æ¸…ç©ºæœ¬åœ°ç¼“å­˜å—ï¼Ÿ","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(function(){localStorage.clear(),e.$message.success("æœ¬åœ°ç¼“å­˜å·²æ¸…ç©º")}).catch(function(){})},toggleBackground:function(e){this.enableBackground=e,this.$message.info(e?"èƒŒæ™¯ç‰¹æ•ˆå·²å¯ç”¨":"èƒŒæ™¯ç‰¹æ•ˆå·²å…³é—­"),this.saveSettings(),this.$root.$emit("toggle-background",e)},changeBackgroundType:function(e){this.backgroundType=e;this.$message.success("å·²åˆ‡æ¢åˆ°".concat({none:"æ— ",image:"å›¾ç‰‡",particle:"ç²’å­",sakura:"æ¨±èŠ±",meteor:"æµæ˜Ÿ",text:"æ–‡å­—æ»šåŠ¨"}[e]||"æœªçŸ¥","èƒŒæ™¯")),this.saveSettings(),this.$root.$emit("change-background-type",e)},changeBackgroundOpacity:function(e){this.backgroundOpacity=e,this.saveSettings(),this.$root.$emit("change-background-opacity",e/100)},changeTextScrollContent:function(){this.saveSettings(),"text"===this.backgroundType&&this.$root.$emit("change-background-type","text")},getBackgroundName:function(e){return{none:"æ— ",particle:"ç²’å­",sakura:"æ¨±èŠ±",fluid:"æµä½“",canvas:"ç”»å¸ƒ",svg:"SVG"}[e]||"æœªçŸ¥"},toggleMouseEffect:function(e){this.enableMouseEffect=e,this.$message.info(e?"é¼ æ ‡ç‰¹æ•ˆå·²å¯ç”¨":"é¼ æ ‡ç‰¹æ•ˆå·²å…³é—­"),this.$root.$emit("toggle-mouse-effect",e),this.saveSettings()},toggleLive2d:function(e){this.enableLive2d=e,this.$message.info(e?"Live2Dçœ‹æ¿å¨˜å·²å¯ç”¨":"Live2Dçœ‹æ¿å¨˜å·²å…³é—­"),this.$root.$emit("toggle-live2d",e),this.saveSettings()},toggleMusic:function(e){this.enableMusic=e,this.$message.info(e?"éŸ³ä¹æ’­æ”¾å™¨å·²å¯ç”¨":"éŸ³ä¹æ’­æ”¾å™¨å·²å…³é—­"),this.$root.$emit("toggle-music",e),this.saveSettings()},toggleTouchFeedback:function(e){this.enableTouchFeedback=e,this.$message.info(e?"è§¦æ‘¸åé¦ˆå·²å¯ç”¨":"è§¦æ‘¸åé¦ˆå·²å…³é—­"),this.$root.$emit("toggle-touch-feedback",e),this.saveSettings()},loadSysConfig:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get(e.$constant.baseURL+"/sysConfig/listSysConfig");case 3:(a=t.sent)&&a.data&&(e.sysConfig=a.data,e.applyServerConfig()),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}))()},applyServerConfig:function(){"false"===this.sysConfig["theme.holiday.enable"]&&(this.enableHolidayTheme=!1),"false"===this.sysConfig["effect.mousedown.enable"]&&(this.enableMouseEffect=!1),"true"===this.sysConfig["component.live2d.enable"]&&(this.enableLive2d=!0)}},watch:{fontSize:function(e){document.documentElement.style.fontSize=e+"px",this.saveSettings()},lineHeight:function(e){document.documentElement.style.lineHeight=e,this.saveSettings()}}},c=o,l=(a("a32b"),a("2877")),r={components:{EnhancedSettingsMenu:Object(l.a)(c,i,[],!1,null,"0642bd84",null).exports},data:function(){return{aplayer:null,aplayerReady:!1,musicInitialized:!1,backgroundManager:null}},computed:{sysConfig:function(){return this.$store.state.sysConfig}},watch:{sysConfig:{handler:function(e){e&&Object.keys(e).length>0&&!this.musicInitialized&&(this.musicInitialized=!0)},deep:!0,immediate:!0}},created:function(){var e=this;Promise.all([a.e("chunk-commons~31ecd969"),a.e("chunk-2d0aa1bb")]).then(a.bind(null,"1039")).then(function(t){var a=t.default;e.backgroundManager=new a,setTimeout(function(){e.restoreBackgroundSettings()},300)}),this.setupUserInteraction(),this.getWebInfo(),this.$root.$on("toggle-music",this.handleMusicToggle),this.$root.$on("toggle-live2d",this.handleLive2dToggle),this.$root.$on("change-background-type",this.handleBackgroundTypeChange),this.$root.$on("toggle-background",this.handleBackgroundToggle),this.$root.$on("change-background-opacity",this.handleBackgroundOpacityChange),this.$nextTick(function(){var t=localStorage.getItem("poetize-settings");if(t)try{var a=JSON.parse(t);!1===a.enableMusic&&e.handleMusicToggle(!1),!1===a.enableLive2d&&e.handleLive2dToggle(!1)}catch(e){}})},mounted:function(){},beforeDestroy:function(){this.aplayer&&this.aplayer.destroy(),this.backgroundManager&&(this.backgroundManager.destroy(),this.backgroundManager=null),this.$root.$off("toggle-music",this.handleMusicToggle),this.$root.$off("toggle-live2d",this.handleLive2dToggle),this.$root.$off("change-background-type",this.handleBackgroundTypeChange),this.$root.$off("toggle-background",this.handleBackgroundToggle),this.$root.$off("change-background-opacity",this.handleBackgroundOpacityChange)},methods:{getWebInfo:function(){var e=this;this.$http.get(this.$constant.baseURL+"/webInfo/getWebInfo").then(function(t){e.$common.isEmpty(t.data)||(e.$store.commit("loadWebInfo",t.data),localStorage.setItem("defaultStoreType",t.data.defaultStoreType))}).catch(function(e){})},setupUserInteraction:function(){var e=this,t=function t(){e.musicInitialized&&!e.aplayer&&(e.initAplayer(),document.removeEventListener("click",t),document.removeEventListener("touchstart",t),document.removeEventListener("keydown",t))};document.addEventListener("click",t),document.addEventListener("touchstart",t),document.addEventListener("keydown",t)},initAplayer:function(){var e=this,t=this.sysConfig["aplayer.playlist.id"]||"2158283120",a=this.sysConfig["aplayer.server"]||"netease";this.loadAPlayerLibs().then(function(){if("undefined"!=typeof APlayer){e.aplayer=new APlayer({container:document.getElementById("global-aplayer"),fixed:!0,autoplay:!0,theme:"#667eea",loop:"all",order:"random",preload:"auto",volume:.7,mutex:!0,listFolded:!1,audio:[]});var i=["https://api.injahow.cn/meting/?server=".concat(a,"&type=playlist&id=").concat(t),"https://music.xf857.com/api.php?server=".concat(a,"&type=playlist&id=").concat(t)],n=0;!function t(){n>=i.length?e.loadFallbackMusic():fetch(i[n]).then(function(e){if(!e.ok)throw new Error("HTTP ".concat(e.status));return e.json()}).then(function(t){if(!(t&&Array.isArray(t)&&t.length>0))throw new Error("APIè¿”å›æ•°æ®ä¸ºç©º");e.aplayer.list.clear(),e.aplayer.list.add(t),e.aplayerReady=!0,e.$nextTick(function(){e.initAPlayerDrag()}),e.aplayer.on("play",function(){}),e.aplayer.on("error",function(){setTimeout(function(){e.aplayer&&e.aplayer.list.audios.length>1&&e.aplayer.skipForward()},500)}),setTimeout(function(){if(e.aplayer&&e.aplayer.paused&&"function"==typeof e.aplayer.play){var t=e.aplayer.play();t&&"function"==typeof t.catch&&t.catch(function(e){})}},500)}).catch(function(e){n++,t()})}()}})},loadFallbackMusic:function(){var e=this;this.aplayer.list.clear(),this.aplayer.list.add([{name:"èµ·é£äº†",artist:"ä¹°è¾£æ¤’ä¹Ÿç”¨åˆ¸",url:"https://music.163.com/song/media/outer/url?id=1330348068.mp3",cover:"https://p1.music.126.net/diGAyEmpymX8G7JcnElncQ==/109951163699673355.jpg"},{name:"æ™´å¤©",artist:"å‘¨æ°ä¼¦",url:"https://music.163.com/song/media/outer/url?id=186016.mp3",cover:"https://p1.music.126.net/Md3RLH0fe2a_3AMPJHFe-A==/7934075906687672.jpg"},{name:"æµ·é˜”å¤©ç©º",artist:"Beyond",url:"https://music.163.com/song/media/outer/url?id=346576.mp3",cover:"https://p1.music.126.net/QHw-RuMcsyXPSy3Xcd_PBQ==/18805696695122492.jpg"}]),this.aplayerReady=!0,this.$nextTick(function(){e.initAPlayerDrag()}),setTimeout(function(){if(e.aplayer&&e.aplayer.paused&&"function"==typeof e.aplayer.play){var t=e.aplayer.play();t&&"function"==typeof t.catch&&t.catch(function(e){})}},500)},loadAPlayerLibs:function(){return new Promise(function(e,t){if("undefined"==typeof APlayer){var a=[{css:"https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css",js:"https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js",meting:"https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"},{css:"https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.css",js:"https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js",meting:"https://cdn.bootcdn.net/ajax/libs/meting/2.0.1/Meting.min.js"},{css:"https://lib.baomitu.com/aplayer/1.10.1/APlayer.min.css",js:"https://lib.baomitu.com/aplayer/1.10.1/APlayer.min.js",meting:"https://lib.baomitu.com/meting/2.0.1/Meting.min.js"}],i=0;!function t(){if(i>=a.length)e();else{var n=a[i],s=document.createElement("link");s.rel="stylesheet",s.href=n.css,s.onload=function(){var a=document.createElement("script");a.src=n.js,a.onload=function(){var t=document.createElement("script");t.src=n.meting,t.onload=function(){e()},t.onerror=function(){e()},document.body.appendChild(t)},a.onerror=function(){i++,t()},document.body.appendChild(a)},s.onerror=function(){i++,t()},document.head.appendChild(s)}}()}else e()})},initAPlayerDrag:function(){var e=this;setTimeout(function(){var t=document.querySelector(".aplayer.aplayer-fixed");if(t){var a,i,n,s,o=!1,c=localStorage.getItem("aplayer-position");if(c)try{var l=JSON.parse(c);t.style.left=l.left+"px",t.style.bottom=l.bottom+"px",t.style.right="auto"}catch(a){e.setAPlayerDefaultPosition(t)}else e.setAPlayerDefaultPosition(t);t.addEventListener("mousedown",function(e){if(!(e.target.closest("button")||e.target.closest(".aplayer-icon")||e.target.closest(".aplayer-volume-bar")||e.target.closest(".aplayer-bar")||e.target.closest(".aplayer-list-item")||e.target.closest("input")||e.target.closest("a"))){o=!0,t.classList.add("dragging"),a=e.clientX,i=e.clientY;var c=t.getBoundingClientRect();n=c.left,s=window.innerHeight-c.bottom,e.preventDefault(),e.stopPropagation()}},!0),document.addEventListener("mousemove",function(e){if(o){var c=e.clientX-a,l=e.clientY-i,r=n+c,d=s-l,u=t.offsetWidth,g=t.offsetHeight;r=Math.max(0,Math.min(r,window.innerWidth-u)),d=Math.max(0,Math.min(d,window.innerHeight-g)),t.style.left=r+"px",t.style.bottom=d+"px",t.style.right="auto",e.preventDefault()}}),document.addEventListener("mouseup",function(){if(o){o=!1,t.classList.remove("dragging");var e=t.getBoundingClientRect(),a={left:e.left,bottom:window.innerHeight-e.bottom};localStorage.setItem("aplayer-position",JSON.stringify(a))}})}else setTimeout(function(){return e.initAPlayerDrag()},1e3)},500)},setAPlayerDefaultPosition:function(e){e.style.left="auto",e.style.right="0px",e.style.bottom="0px"},handleMusicToggle:function(e){if(e){if(this.aplayer){var t=document.querySelector(".aplayer-wrapper");t&&(t.style.display="block"),this.aplayer.paused&&this.aplayer.play().catch(function(e){})}else this.initAplayer();this.$message.success("ğŸµ éŸ³ä¹æ’­æ”¾å™¨å·²å¯ç”¨")}else{this.aplayer&&this.aplayer.pause();var a=document.querySelector(".aplayer-wrapper");a&&(a.style.display="none"),this.$message.info("ğŸµ éŸ³ä¹æ’­æ”¾å™¨å·²å…³é—­")}},handleLive2dToggle:function(e){var t=document.getElementById("waifu"),a=document.getElementById("waifu-toggle");e?(t&&(t.style.display="block"),a&&(a.style.display="block"),this.$message.success("Live2Dçœ‹æ¿å¨˜å·²å¯ç”¨")):(t&&(t.style.display="none"),a&&(a.style.display="none"),this.$message.info("Live2Dçœ‹æ¿å¨˜å·²å…³é—­"))},restoreBackgroundSettings:function(){var e=localStorage.getItem("poetize-settings");if(e)try{var t=JSON.parse(e);void 0!==t.backgroundOpacity&&this.backgroundManager.setOpacity(t.backgroundOpacity),t.enableBackground&&t.backgroundType&&"none"!==t.backgroundType&&this.applyBackgroundType(t.backgroundType)}catch(e){}},handleBackgroundTypeChange:function(e){this.backgroundManager&&(this.applyBackgroundType(e),localStorage.setItem("backgroundType",e))},applyBackgroundType:function(e){if(this.backgroundManager){if(this.backgroundManager.clear(),"none"===e)return this.backgroundManager.restoreOriginalBackground(),void this.$message.info("èƒŒæ™¯ç‰¹æ•ˆå·²å…³é—­");switch(e){case"particle":this.backgroundManager.setParticleBackground(),this.$message.success("âœ¨ ç²’å­èƒŒæ™¯å·²å¯ç”¨");break;case"sakura":this.backgroundManager.setSakuraBackground(),this.$message.success("ğŸŒ¸ æ¨±èŠ±èƒŒæ™¯å·²å¯ç”¨");break;case"meteor":this.backgroundManager.setMeteorBackground(),this.$message.success("â˜„ï¸ æµæ˜ŸèƒŒæ™¯å·²å¯ç”¨")}}},handleBackgroundToggle:function(e){if(this.backgroundManager)if(e){var t=localStorage.getItem("poetize-settings");if(t)try{var a=JSON.parse(t);a.backgroundType&&"none"!==a.backgroundType&&this.applyBackgroundType(a.backgroundType)}catch(e){}}else this.backgroundManager.clear(),this.backgroundManager.restoreOriginalBackground(),this.$message.info("èƒŒæ™¯ç‰¹æ•ˆå·²å…³é—­")},handleBackgroundOpacityChange:function(e){this.backgroundManager&&this.backgroundManager.setOpacity(e)}}},d=r,u=(a("034f"),Object(l.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view"),a("div",{directives:[{name:"show",rawName:"v-show",value:e.aplayerReady,expression:"aplayerReady"}],staticClass:"aplayer-wrapper"},[a("div",{attrs:{id:"global-aplayer"}})]),a("EnhancedSettingsMenu")],1)},[],!1,null,null,null));t.a=u.exports},"3e78":function(e,t,a){"use strict";a("d3b7"),a("159b"),a("2ca0");var i=a("cf85"),n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",s={rootMargin:"500px",threshold:.01},o=null;function c(e){var t=e.dataset.src;if(t){var a=e.dataset.optimize||"smart",s=t;switch(a){case"mobile":s=i.a.optimizeForMobile(t);break;case"network":s=i.a.optimizeByNetwork(t);break;case"smart":s=i.a.smartOptimize(t);break;default:s=t}if("true"===e.dataset.progressive)i.a.progressiveLoad(e,s);else{e.classList.add("img-loading");var o=new Image;o.onload=function(){e.src=s,e.classList.remove("img-loading"),e.classList.add("img-loaded"),e.dispatchEvent(new CustomEvent("lazyloaded",{detail:{src:s}}))},o.onerror=function(){e.classList.remove("img-loading"),e.classList.add("img-error"),e.src=e.dataset.errorSrc||n,e.dispatchEvent(new CustomEvent("lazyerror",{detail:{src:t}}))},o.src=s}}}t.a={bind:function(e,t){t.value?e.dataset.src=t.value:e.src&&!e.src.startsWith("data:")&&(e.dataset.src=e.src),e.src=e.dataset.placeholder||n,e.classList.add("lazy-img"),t.arg&&(e.dataset.optimize=t.arg),t.modifiers.progressive&&(e.dataset.progressive="true");var a=function(e){return o||(window.IntersectionObserver?(o=new IntersectionObserver(function(t){t.forEach(function(t){t.isIntersecting&&(e(t.target),o.unobserve(t.target))})},s),o):null)}(c);a?a.observe(e):c(e)},update:function(e,t){t.value!==t.oldValue&&(e.dataset.src=t.value,e.classList.contains("img-loaded")&&c(e))},unbind:function(e){o&&o.unobserve(e)},mounted:function(e,t){this.bind(e,t)},updated:function(e,t){this.update(e,t)},unmounted:function(e){this.unbind(e)}}},"85ec":function(e,t,a){},a32b:function(e,t,a){"use strict";a("17ec")},fd15:function(e,t,a){"use strict";a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("caad"),a("2532"),a("99af"),a("159b");var i=function(){try{return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch(e){return!1}}(),n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",s="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2YwZjBmMCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7lm77niYfliqDovb3lpLHotKU8L3RleHQ+PC9zdmc+",o=new Set,c=function(e){if(!e||!i)return e;if(e.includes(".webp"))return e;if(e.includes("qiniu")||e.includes("cdn")){var t=e.includes("?")?"&":"?";return"".concat(e).concat(t,"imageMogr2/format/webp")}return e},l=function(e){return new Promise(function(t,a){var i=new Image;i.onload=function(){return t(e)},i.onerror=a,i.src=e})},r=null,d=function(){return r||(r=new IntersectionObserver(function(e){e.forEach(function(e){if(e.isIntersecting){var t=e.target,a=t.dataset.src,i=t.dataset.error;if(a&&!o.has(a)){t.classList.add("lazy-loading");var n=c(a);l(n).then(function(){t.src=n,t.classList.remove("lazy-loading"),t.classList.add("lazy-loaded"),o.add(a),r.unobserve(t)}).catch(function(){n!==a?l(a).then(function(){t.src=a,t.classList.remove("lazy-loading"),t.classList.add("lazy-loaded"),o.add(a),r.unobserve(t)}).catch(function(){t.src=i||s,t.classList.remove("lazy-loading"),t.classList.add("lazy-error"),r.unobserve(t)}):(t.src=i||s,t.classList.remove("lazy-loading"),t.classList.add("lazy-error"),r.unobserve(t))})}else o.has(a)&&(t.src=c(a),t.classList.add("lazy-loaded"),r.unobserve(t))}})},{rootMargin:"50px",threshold:.01})),r};t.a={install:function(e){e.directive("lazy",{bind:function(e,t){if(e.src=n,e.dataset.src=t.value,t.modifiers.error&&t.arg&&(e.dataset.error=t.arg),e.classList.add("lazy-image"),o.has(t.value))e.src=c(t.value),e.classList.add("lazy-loaded");else if("IntersectionObserver"in window)d().observe(e);else{var a=c(t.value);l(a).then(function(){e.src=a,e.classList.add("lazy-loaded"),o.add(t.value)}).catch(function(){e.src=e.dataset.error||s,e.classList.add("lazy-error")})}},update:function(e,t){if(t.value!==t.oldValue)if(e.dataset.src=t.value,e.src=n,e.classList.remove("lazy-loaded","lazy-loading","lazy-error"),e.classList.add("lazy-image"),o.has(t.value))e.src=c(t.value),e.classList.add("lazy-loaded");else if("IntersectionObserver"in window)d().observe(e);else{var a=c(t.value);l(a).then(function(){e.src=a,e.classList.add("lazy-loaded"),o.add(t.value)}).catch(function(){e.src=e.dataset.error||s,e.classList.add("lazy-error")})}},unbind:function(e){r&&r.unobserve(e)}})}}}}]);