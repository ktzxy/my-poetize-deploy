(window.webpackJsonp=window.webpackJsonp||[]).push([["admin-commentaudit~d04c6680"],{"0e0e":function(t,e,a){},"545b":function(t,e,a){"use strict";a("0e0e")},d4019:function(t,e,a){"use strict";a.r(e);var s=a("5530"),n=(a("d81d"),{name:"CommentAudit",data:function(){return{searchParams:{auditStatus:null,commentType:"",hasSensitiveWord:!1,hasReport:!1},pagination:{current:1,size:10,total:0},comments:[],selectedComments:[],detailDialogVisible:!1,currentComment:null,rejectDialogVisible:!1,rejectForm:{reason:"",commentIds:[]},reportsDialogVisible:!1,reports:[]}},created:function(){this.loadComments()},methods:{loadComments:function(){var t=this,e=Object(s.a)({current:this.pagination.current,size:this.pagination.size},this.searchParams);this.$http.post(this.$constant.baseURL+"/admin/comment/boss/list",e,!0).then(function(e){e&&e.data&&(t.comments=e.data.records||[],t.pagination.total=e.data.total||0)}).catch(function(e){t.$message.error(e.message||"加载失败")})},handleSearch:function(){this.pagination.current=1,this.loadComments()},handleReset:function(){this.searchParams={auditStatus:null,commentType:"",hasSensitiveWord:!1,hasReport:!1},this.pagination.current=1,this.loadComments()},handleSelectionChange:function(t){this.selectedComments=t},handlePageChange:function(t){this.pagination.current=t,this.loadComments()},handleAudit:function(t,e){var a=this;this.$http.post(this.$constant.baseURL+"/admin/comment/boss/audit",null,!0,{commentId:t.id,auditStatus:e}).then(function(){a.$message.success(1===e?"审核通过！":"审核拒绝！"),a.loadComments()}).catch(function(t){a.$message.error(t.message||"操作失败")})},handleReject:function(t){this.rejectForm.commentIds=[t.id],this.rejectForm.reason="",this.rejectDialogVisible=!0},handleBatchAudit:function(t){var e=this;if(0!==this.selectedComments.length){var a=this.selectedComments.map(function(t){return t.id});this.$http.post(this.$constant.baseURL+"/admin/comment/boss/auditBatch",a,!0,{auditStatus:t}).then(function(){e.$message.success("批量审核成功！"),e.loadComments(),e.selectedComments=[]}).catch(function(t){e.$message.error(t.message||"操作失败")})}else this.$message.warning("请选择要审核的评论")},handleBatchReject:function(){0!==this.selectedComments.length?(this.rejectForm.commentIds=this.selectedComments.map(function(t){return t.id}),this.rejectForm.reason="",this.rejectDialogVisible=!0):this.$message.warning("请选择要拒绝的评论")},confirmReject:function(){var t=this;this.rejectForm.reason?this.$http.post(this.$constant.baseURL+"/admin/comment/boss/auditBatch",this.rejectForm.commentIds,!0,{auditStatus:2,rejectReason:this.rejectForm.reason}).then(function(){t.$message.success("拒绝成功！"),t.rejectDialogVisible=!1,t.loadComments(),t.selectedComments=[]}).catch(function(e){t.$message.error(e.message||"操作失败")}):this.$message.warning("请填写拒绝原因")},handleViewDetail:function(t){this.currentComment=t,this.detailDialogVisible=!0},handleViewReports:function(t){var e=this;this.$http.get(this.$constant.baseURL+"/admin/comment/boss/listReports",{commentId:t.id},!0).then(function(t){t&&t.data&&(e.reports=t.data,e.reportsDialogVisible=!0)}).catch(function(t){e.$message.error(t.message||"加载失败")})},handleDelete:function(t){var e=this;this.$confirm("确认删除该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.get(e.$constant.baseURL+"/admin/comment/boss/deleteComment",{id:t.id},!0).then(function(){e.$message.success("删除成功！"),e.loadComments()}).catch(function(t){e.$message.error(t.message||"删除失败")})}).catch(function(){})},handleDetailDialogClose:function(t){this.detailDialogVisible=!1,t&&t()},handleRejectDialogClose:function(t){this.rejectDialogVisible=!1,t&&t()},handleReportsDialogClose:function(t){this.reportsDialogVisible=!1,t&&t()}}}),i=n,o=(a("545b"),a("2877")),l=Object(o.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment-audit-container"},[a("div",{staticClass:"search-bar"},[a("el-select",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"审核状态",clearable:""},model:{value:t.searchParams.auditStatus,callback:function(e){t.$set(t.searchParams,"auditStatus",e)},expression:"searchParams.auditStatus"}},[a("el-option",{attrs:{label:"全部",value:null}}),a("el-option",{attrs:{label:"待审核",value:0}}),a("el-option",{attrs:{label:"已通过",value:1}}),a("el-option",{attrs:{label:"已拒绝",value:2}})],1),a("el-select",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"评论类型",clearable:""},model:{value:t.searchParams.commentType,callback:function(e){t.$set(t.searchParams,"commentType",e)},expression:"searchParams.commentType"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"文章评论",value:"article"}}),a("el-option",{attrs:{label:"树洞留言",value:"message"}}),a("el-option",{attrs:{label:"家庭祝福",value:"love"}})],1),a("el-checkbox",{staticStyle:{"margin-right":"10px"},model:{value:t.searchParams.hasSensitiveWord,callback:function(e){t.$set(t.searchParams,"hasSensitiveWord",e)},expression:"searchParams.hasSensitiveWord"}},[t._v("包含敏感词")]),a("el-checkbox",{staticStyle:{"margin-right":"10px"},model:{value:t.searchParams.hasReport,callback:function(e){t.$set(t.searchParams,"hasReport",e)},expression:"searchParams.hasReport"}},[t._v("被举报")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("搜索")]),a("el-button",{on:{click:t.handleReset}},[t._v("重置")])],1),t.selectedComments.length>0?a("div",{staticClass:"batch-operations"},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v("已选择 "+t._s(t.selectedComments.length)+" 条评论")]),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){return t.handleBatchAudit(1)}}},[t._v("批量通过")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.handleBatchReject}},[t._v("批量拒绝")])],1):t._e(),a("el-table",{staticClass:"comment-table",attrs:{data:t.comments,border:"","header-cell-class-name":"table-header"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60",align:"center"}}),a("el-table-column",{attrs:{label:"审核状态",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:0===e.row.auditStatus?"warning":1===e.row.auditStatus?"success":"danger",size:"small"}},[t._v(" "+t._s(0===e.row.auditStatus?"待审核":1===e.row.auditStatus?"已通过":"已拒绝")+" ")])]}}])}),a("el-table-column",{attrs:{label:"评论内容","min-width":"300","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"comment-content"},[t._v(" "+t._s(e.row.commentContent)+" "),e.row.hasSensitiveWord?a("el-tag",{staticStyle:{"margin-left":"5px"},attrs:{type:"danger",size:"mini"}},[t._v(" 敏感词 ")]):t._e(),e.row.reportCount>0?a("el-tag",{staticStyle:{"margin-left":"5px"},attrs:{type:"warning",size:"mini"}},[t._v(" 被举报"+t._s(e.row.reportCount)+"次 ")]):t._e()],1)]}}])}),a("el-table-column",{attrs:{prop:"type",label:"来源类型",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{label:"操作",width:"280",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleViewDetail(e.row)}}},[t._v(" 详情 ")]),0===e.row.auditStatus?a("el-button",{staticStyle:{color:"#67C23A"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleAudit(e.row,1)}}},[t._v(" 通过 ")]):t._e(),0===e.row.auditStatus?a("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleReject(e.row)}}},[t._v(" 拒绝 ")]):t._e(),e.row.reportCount>0?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleViewReports(e.row)}}},[t._v(" 查看举报 ")]):t._e(),a("el-button",{staticStyle:{color:"var(--orangeRed)"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v(" 删除 ")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","pager-count":5,"current-page":t.pagination.current,"page-size":t.pagination.size,total:t.pagination.total},on:{"current-change":t.handlePageChange}})],1),a("el-dialog",{attrs:{title:"评论详情",visible:t.detailDialogVisible,width:"600px","close-on-click-modal":!1,"before-close":t.handleDetailDialogClose},on:{"update:visible":function(e){t.detailDialogVisible=e}}},[t.currentComment?a("div",{staticClass:"comment-detail"},[a("el-descriptions",{attrs:{column:1,border:""}},[a("el-descriptions-item",{attrs:{label:"评论ID"}},[t._v(t._s(t.currentComment.id))]),a("el-descriptions-item",{attrs:{label:"评论内容"}},[t._v(t._s(t.currentComment.commentContent))]),a("el-descriptions-item",{attrs:{label:"来源类型"}},[t._v(t._s(t.currentComment.type))]),a("el-descriptions-item",{attrs:{label:"创建时间"}},[t._v(t._s(t.currentComment.createTime))]),a("el-descriptions-item",{attrs:{label:"审核状态"}},[a("el-tag",{attrs:{type:0===t.currentComment.auditStatus?"warning":1===t.currentComment.auditStatus?"success":"danger"}},[t._v(" "+t._s(0===t.currentComment.auditStatus?"待审核":1===t.currentComment.auditStatus?"已通过":"已拒绝")+" ")])],1),t.currentComment.auditTime?a("el-descriptions-item",{attrs:{label:"审核时间"}},[t._v(t._s(t.currentComment.auditTime))]):t._e(),t.currentComment.rejectReason?a("el-descriptions-item",{attrs:{label:"拒绝原因"}},[t._v(t._s(t.currentComment.rejectReason))]):t._e(),a("el-descriptions-item",{attrs:{label:"被举报次数"}},[t._v(t._s(t.currentComment.reportCount||0))]),a("el-descriptions-item",{attrs:{label:"包含敏感词"}},[a("el-tag",{attrs:{type:t.currentComment.hasSensitiveWord?"danger":"success",size:"small"}},[t._v(" "+t._s(t.currentComment.hasSensitiveWord?"是":"否")+" ")])],1)],1)],1):t._e()]),a("el-dialog",{attrs:{title:"拒绝评论",visible:t.rejectDialogVisible,width:"500px","close-on-click-modal":!1,"before-close":t.handleRejectDialogClose},on:{"update:visible":function(e){t.rejectDialogVisible=e}}},[a("el-form",{attrs:{model:t.rejectForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"拒绝原因"}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入拒绝原因...",maxlength:"500","show-word-limit":""},model:{value:t.rejectForm.reason,callback:function(e){t.$set(t.rejectForm,"reason",e)},expression:"rejectForm.reason"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.rejectDialogVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmReject}},[t._v("确定")])],1)],1),a("el-dialog",{attrs:{title:"举报记录",visible:t.reportsDialogVisible,width:"800px","close-on-click-modal":!1,"before-close":t.handleReportsDialogClose},on:{"update:visible":function(e){t.reportsDialogVisible=e}}},[a("el-table",{attrs:{data:t.reports,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60",align:"center"}}),a("el-table-column",{attrs:{prop:"reason",label:"举报原因",align:"center"}}),a("el-table-column",{attrs:{prop:"detail",label:"详细说明","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"状态",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:0===e.row.status?"warning":1===e.row.status?"success":"info",size:"small"}},[t._v(" "+t._s(0===e.row.status?"待处理":1===e.row.status?"已处理":"已忽略")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"举报时间",width:"160",align:"center"}})],1)],1)],1)},[],!1,null,"3958b4e2",null);e.default=l.exports}}]);