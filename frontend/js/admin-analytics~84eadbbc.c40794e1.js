(window.webpackJsonp=window.webpackJsonp||[]).push([["admin-analytics~84eadbbc"],{"590c":function(t,a,s){"use strict";s("e50b")},e50b:function(t,a,s){},ece0:function(t,a,s){"use strict";s.r(a);var e=(s("d81d"),s("b0c0"),{name:"VisitorAnalysis",data:function(){return{overview:{},visitorLogs:[],loading:!1,pagination:{current:1,size:20,total:0}}},created:function(){this.loadOverview(),this.loadVisitorLogs()},mounted:function(){this.loadCharts()},methods:{loadOverview:function(){var t=this;this.$http.get(this.$constant.baseURL+"/admin/statistics/visitor-overview",{},!0).then(function(a){200===a.code&&a.data&&(t.overview={totalVisits:a.data.totalVisits||0,todayVisits:a.data.todayVisits||0,uniqueVisitors:a.data.uniqueVisitors||0})}).catch(function(a){t.$message.error("加载统计数据失败")})},loadVisitorLogs:function(){var t=this;this.loading=!0,this.$http.get(this.$constant.baseURL+"/admin/statistics/visitor-logs",{page:this.pagination.current,size:this.pagination.size},!0).then(function(a){t.loading=!1,200===a.code&&a.data&&(t.visitorLogs=a.data.logs||[],t.pagination.total=a.data.total||0)}).catch(function(a){t.loading=!1,t.$message.error("加载访客记录失败")})},loadCharts:function(){this.loadTrendChart(),this.loadBrowserChart(),this.loadOsChart()},loadTrendChart:function(){var t=this;this.$http.get(this.$constant.baseURL+"/admin/statistics/user-growth?days=30",{},!0).then(function(a){200===a.code&&a.data&&t.renderTrendChart(a.data)}).catch(function(t){})},loadBrowserChart:function(){var t=this;this.$http.get(this.$constant.baseURL+"/admin/statistics/browser-stats",{},!0).then(function(a){if(200===a.code&&a.data&&a.data.length>0){var s=a.data.map(function(t){return{name:t.browser||"Unknown",value:t.count||0}});t.renderPieChart(t.$refs.browserChart,s,"浏览器分布")}else{t.renderPieChart(t.$refs.browserChart,[{name:"暂无数据",value:1}],"浏览器分布")}}).catch(function(t){})},loadOsChart:function(){var t=this;this.$http.get(this.$constant.baseURL+"/admin/statistics/os-stats",{},!0).then(function(a){if(200===a.code&&a.data&&a.data.length>0){var s=a.data.map(function(t){return{name:t.os||"Unknown",value:t.count||0}});t.renderPieChart(t.$refs.osChart,s,"操作系统分布")}else{t.renderPieChart(t.$refs.osChart,[{name:"暂无数据",value:1}],"操作系统分布")}}).catch(function(t){})},renderTrendChart:function(t){if(void 0!==window.echarts&&this.$refs.trendChart){var a=window.echarts.init(this.$refs.trendChart),s={tooltip:{trigger:"axis"},xAxis:{type:"category",data:t.map(function(t){return t.date}),axisLabel:{rotate:45}},yAxis:{type:"value"},series:[{name:"访问量",type:"line",smooth:!0,data:t.map(function(t){return t.count}),areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(102, 126, 234, 0.5)"},{offset:1,color:"rgba(102, 126, 234, 0.1)"}]}}}]};a.setOption(s)}},renderPieChart:function(t,a,s){if(void 0!==window.echarts&&t){var e=window.echarts.init(t),i={tooltip:{trigger:"item"},series:[{name:s,type:"pie",radius:"60%",data:a.map(function(t){return{name:t.name||t.region,value:t.value||t.count}}),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};e.setOption(i)}},handlePageChange:function(t){this.pagination.current=t,this.loadVisitorLogs()},formatTime:function(t){return t?new Date(t).toLocaleString("zh-CN"):""}}}),i=e,r=(s("590c"),s("2877")),n=Object(r.a)(i,function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"visitor-analysis"},[t._m(0),s("el-row",{staticClass:"overview-cards",attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("div",{staticClass:"stat-card"},[s("div",{staticClass:"stat-icon",staticStyle:{background:"#667eea"}},[s("i",{staticClass:"el-icon-view"})]),s("div",{staticClass:"stat-content"},[s("div",{staticClass:"stat-value"},[t._v(t._s(t.overview.totalVisits||0))]),s("div",{staticClass:"stat-label"},[t._v("总访问量")])])])]),s("el-col",{attrs:{span:8}},[s("div",{staticClass:"stat-card"},[s("div",{staticClass:"stat-icon",staticStyle:{background:"#4fd1c5"}},[s("i",{staticClass:"el-icon-sunny"})]),s("div",{staticClass:"stat-content"},[s("div",{staticClass:"stat-value"},[t._v(t._s(t.overview.todayVisits||0))]),s("div",{staticClass:"stat-label"},[t._v("今日访问")])])])]),s("el-col",{attrs:{span:8}},[s("div",{staticClass:"stat-card"},[s("div",{staticClass:"stat-icon",staticStyle:{background:"#f6ad55"}},[s("i",{staticClass:"el-icon-user"})]),s("div",{staticClass:"stat-content"},[s("div",{staticClass:"stat-value"},[t._v(t._s(t.overview.uniqueVisitors||0))]),s("div",{staticClass:"stat-label"},[t._v("独立访客")])])])])],1),s("el-card",{staticClass:"chart-card",attrs:{shadow:"never"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("访问趋势（最近30天）")])]),s("div",{ref:"trendChart",staticStyle:{width:"100%",height:"300px"}})]),s("el-row",{staticClass:"stats-row",attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-card",{attrs:{shadow:"never"}},[s("div",{attrs:{slot:"header"},slot:"header"},[t._v("浏览器分布")]),s("div",{ref:"browserChart",staticStyle:{width:"100%",height:"300px"}})])],1),s("el-col",{attrs:{span:12}},[s("el-card",{attrs:{shadow:"never"}},[s("div",{attrs:{slot:"header"},slot:"header"},[t._v("操作系统分布")]),s("div",{ref:"osChart",staticStyle:{width:"100%",height:"300px"}})])],1)],1),s("el-card",{staticClass:"visitor-logs",attrs:{shadow:"never"}},[s("div",{attrs:{slot:"header"},slot:"header"},[t._v("访客记录")]),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.visitorLogs,stripe:""}},[s("el-table-column",{attrs:{prop:"ipAddress",label:"IP地址",width:"150"}}),s("el-table-column",{attrs:{prop:"location",label:"地区",width:"120"}}),s("el-table-column",{attrs:{prop:"browser",label:"浏览器",width:"100"}}),s("el-table-column",{attrs:{prop:"os",label:"操作系统",width:"100"}}),s("el-table-column",{attrs:{prop:"device",label:"设备",width:"100"}}),s("el-table-column",{attrs:{prop:"visitUrl",label:"访问页面","min-width":"200"}}),s("el-table-column",{attrs:{label:"访问时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatTime(a.row.visitTime))+" ")]}}])})],1),s("el-pagination",{staticStyle:{"margin-top":"20px","text-align":"center"},attrs:{"current-page":t.pagination.current,"page-size":t.pagination.size,total:t.pagination.total,layout:"total, prev, pager, next"},on:{"current-change":t.handlePageChange}})],1)],1)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"header"},[s("h2",[s("i",{staticClass:"el-icon-data-analysis"}),t._v(" 访客分析")])])}],!1,null,"6bd37670",null);a.default=n.exports}}]);