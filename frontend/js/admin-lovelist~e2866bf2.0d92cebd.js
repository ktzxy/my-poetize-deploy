(window.webpackJsonp=window.webpackJsonp||[]).push([["admin-lovelist~e2866bf2"],{"273f":function(e,t,a){"use strict";a.r(t);var o={components:{uploadPicture:(a("d3b7"),a("3ca3"),a("ddb0"),a("2ca0"),function(){return a.e("chunk-commons~31ecd969").then(a.bind(null,"6034"))})},data:function(){return{pagination:{current:1,size:10,total:0,status:null},loves:[],dialogVisible:!1,dialogTitle:"",submitLoading:!1,isEdit:!1,currentCoverType:"",loveForm:{id:null,userId:null,manName:"",womanName:"",manCover:"",womanCover:"",bgCover:"",timing:"",countdownTitle:"",countdownTime:"",familyInfo:"",status:!0},uploadDialogVisible:!1,currentUploadType:"",rules:{manName:[{required:!0,message:"请输入男生昵称",trigger:"blur"}],womanName:[{required:!0,message:"请输入女生昵称",trigger:"blur"}],manCover:[{required:!0,message:"请输入男生头像",trigger:"blur"}],womanCover:[{required:!0,message:"请输入女生头像",trigger:"blur"}],bgCover:[{required:!0,message:"请输入背景封面",trigger:"blur"}],timing:[{required:!0,message:"请选择计时起点",trigger:"change"}]}}},computed:{uploadDialogTitle:function(){return{man:"上传男生头像",woman:"上传女生头像",bg:"上传背景封面"}[this.currentUploadType]||"上传图片"}},watch:{},created:function(){this.getLoves()},mounted:function(){},methods:{handleAdd:function(){this.isEdit=!1,this.dialogTitle="新增表白墙",this.dialogVisible=!0,this.resetForm()},handleEdit:function(e){var t=this;this.isEdit=!0,this.dialogTitle="编辑表白墙",this.dialogVisible=!0,this.$nextTick(function(){t.loveForm={id:e.id,userId:e.userId,manName:e.manName,womanName:e.womanName,manCover:e.manCover,womanCover:e.womanCover,bgCover:e.bgCover,timing:e.timing,countdownTitle:e.countdownTitle||"",countdownTime:e.countdownTime||"",familyInfo:e.familyInfo||"",status:e.status}})},selectCover:function(e){this.currentUploadType=e,this.uploadDialogVisible=!0},handleUploadClose:function(){this.currentUploadType=""},addPicture:function(e){"man"===this.currentUploadType?this.loveForm.manCover=e:"woman"===this.currentUploadType?this.loveForm.womanCover=e:"bg"===this.currentUploadType&&(this.loveForm.bgCover=e),this.uploadDialogVisible=!1,this.$message({message:"图片上传成功！",type:"success"})},submitForm:function(){var e=this;this.$refs.loveForm.validate(function(t){if(t){e.submitLoading=!0;var a=e.$constant.baseURL+"/family/saveFamily";e.$http.post(a,e.loveForm,!0).then(function(t){e.$message({message:e.isEdit?"修改成功！":"新增成功！",type:"success"}),e.dialogVisible=!1,e.getLoves()}).catch(function(t){e.$message({message:t.message,type:"error"})}).finally(function(){e.submitLoading=!1})}})},resetForm:function(){this.loveForm={id:null,userId:null,manName:"",womanName:"",manCover:"",womanCover:"",bgCover:"",timing:"",countdownTitle:"",countdownTime:"",familyInfo:"",status:!0},this.$refs.loveForm&&this.$refs.loveForm.clearValidate()},handleClose:function(){this.dialogVisible=!1,this.resetForm()},handleDelete:function(e){var t=this;this.$confirm("确认删除资源？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success",center:!0}).then(function(){t.$http.get(t.$constant.baseURL+"/family/deleteFamily",{id:e.id},!0).then(function(e){t.pagination.current=1,t.getLoves(),t.$message({message:"删除成功！",type:"success"})}).catch(function(e){t.$message({message:e.message,type:"error"})})}).catch(function(){t.$message({type:"success",message:"已取消删除!"})})},search:function(){this.pagination.total=0,this.pagination.current=1,this.getLoves()},getLoves:function(){var e=this;this.$http.post(this.$constant.baseURL+"/family/listFamily",this.pagination,!0).then(function(t){e.$common.isEmpty(t.data)||(e.loves=t.data.records,e.pagination.total=t.data.total)}).catch(function(t){e.$message({message:t.message,type:"error"})})},changeStatus:function(e){var t=this;this.$http.get(this.$constant.baseURL+"/family/changeLoveStatus",{id:e.id,flag:e.status},!0).then(function(e){t.$message({message:"修改成功！",type:"success"})}).catch(function(e){t.$message({message:e.message,type:"error"})})},handlePageChange:function(e){this.pagination.current=e,this.getLoves()},getFullImageUrl:function(e){return e?(e.startsWith("http")||(e.startsWith("/resourceStorage/")||e.startsWith("resourceStorage/")||(e=e.startsWith("/")?"resourceStorage"+e:"resourceStorage/"+e),e.startsWith(this.$constant.baseURL)||(e=this.$constant.baseURL+"/"+e)),e):""}}},l=o,n=(a("46d0"),a("2877")),r=Object(n.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"mrb10",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("新增表白墙")]),a("el-select",{staticClass:"handle-select mrb10",attrs:{clearable:"",placeholder:"状态"},model:{value:e.pagination.status,callback:function(t){e.$set(e.pagination,"status",t)},expression:"pagination.status"}},[a("el-option",{key:"1",attrs:{label:"启用",value:!0}}),a("el-option",{key:"2",attrs:{label:"禁用",value:!1}})],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")])],1),a("el-table",{staticClass:"table",attrs:{data:e.loves,border:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"userId",label:"用户ID",align:"center"}}),a("el-table-column",{attrs:{prop:"manName",label:"男生昵称",align:"center"}}),a("el-table-column",{attrs:{prop:"womanName",label:"女生昵称",align:"center"}}),a("el-table-column",{attrs:{label:"背景封面",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticClass:"table-td-thumb",attrs:{lazy:"","preview-src-list":[e.getFullImageUrl(t.row.bgCover)],src:e.getFullImageUrl(t.row.bgCover),fit:"cover"}})]}}])}),a("el-table-column",{attrs:{label:"男生头像",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticClass:"table-td-thumb",attrs:{lazy:"","preview-src-list":[e.getFullImageUrl(t.row.manCover)],src:e.getFullImageUrl(t.row.manCover),fit:"cover"}})]}}])}),a("el-table-column",{attrs:{label:"女生头像",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticClass:"table-td-thumb",attrs:{lazy:"","preview-src-list":[e.getFullImageUrl(t.row.womanCover)],src:e.getFullImageUrl(t.row.womanCover),fit:"cover"}})]}}])}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:!1===t.row.status?"danger":"success","disable-transitions":""}},[e._v(" "+e._s(!1===t.row.status?"禁用":"启用")+" ")]),a("el-switch",{nativeOn:{click:function(a){return e.changeStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),a("el-table-column",{attrs:{prop:"timing",label:"计时",align:"center"}}),a("el-table-column",{attrs:{prop:"countdownTitle",label:"倒计时标题",align:"center"}}),a("el-table-column",{attrs:{prop:"countdownTime",label:"倒计时时间",align:"center"}}),a("el-table-column",{attrs:{prop:"familyInfo",label:"额外信息",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"}}),a("el-table-column",{attrs:{prop:"updateTime",label:"最终修改时间",align:"center"}}),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"var(--blue)"},attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v(" 编辑 ")]),a("el-button",{staticStyle:{color:"var(--orangeRed)"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v(" 删除 ")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","pager-count":5,"current-page":e.pagination.current,"page-size":e.pagination.size,total:e.pagination.total},on:{"current-change":e.handlePageChange}})],1)],1),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"60%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[a("el-form",{ref:"loveForm",attrs:{model:e.loveForm,rules:e.rules,"label-width":"120px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"男生昵称",prop:"manName"}},[a("el-input",{attrs:{placeholder:"请输入男生昵称"},model:{value:e.loveForm.manName,callback:function(t){e.$set(e.loveForm,"manName",t)},expression:"loveForm.manName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"女生昵称",prop:"womanName"}},[a("el-input",{attrs:{placeholder:"请输入女生昵称"},model:{value:e.loveForm.womanName,callback:function(t){e.$set(e.loveForm,"womanName",t)},expression:"loveForm.womanName"}})],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"男生头像",prop:"manCover"}},[a("el-input",{attrs:{placeholder:"请输入男生头像URL"},model:{value:e.loveForm.manCover,callback:function(t){e.$set(e.loveForm,"manCover",t)},expression:"loveForm.manCover"}},[a("template",{slot:"append"},[a("el-button",{attrs:{icon:"el-icon-picture"},on:{click:function(t){return e.selectCover("man")}}},[e._v("选择")])],1)],2),e.loveForm.manCover?a("el-image",{staticStyle:{width:"80px",height:"80px","margin-top":"10px"},attrs:{src:e.getFullImageUrl(e.loveForm.manCover),fit:"cover"}}):e._e()],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"女生头像",prop:"womanCover"}},[a("el-input",{attrs:{placeholder:"请输入女生头像URL"},model:{value:e.loveForm.womanCover,callback:function(t){e.$set(e.loveForm,"womanCover",t)},expression:"loveForm.womanCover"}},[a("template",{slot:"append"},[a("el-button",{attrs:{icon:"el-icon-picture"},on:{click:function(t){return e.selectCover("woman")}}},[e._v("选择")])],1)],2),e.loveForm.womanCover?a("el-image",{staticStyle:{width:"80px",height:"80px","margin-top":"10px"},attrs:{src:e.getFullImageUrl(e.loveForm.womanCover),fit:"cover"}}):e._e()],1)],1)],1),a("el-form-item",{attrs:{label:"背景封面",prop:"bgCover"}},[a("el-input",{attrs:{placeholder:"请输入背景封面URL"},model:{value:e.loveForm.bgCover,callback:function(t){e.$set(e.loveForm,"bgCover",t)},expression:"loveForm.bgCover"}},[a("template",{slot:"append"},[a("el-button",{attrs:{icon:"el-icon-picture"},on:{click:function(t){return e.selectCover("bg")}}},[e._v("选择")])],1)],2),e.loveForm.bgCover?a("el-image",{staticStyle:{width:"200px",height:"100px","margin-top":"10px"},attrs:{src:e.getFullImageUrl(e.loveForm.bgCover),fit:"cover"}}):e._e()],1),a("el-form-item",{attrs:{label:"计时起点",prop:"timing"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择计时起点","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.loveForm.timing,callback:function(t){e.$set(e.loveForm,"timing",t)},expression:"loveForm.timing"}})],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"倒计时标题"}},[a("el-input",{attrs:{placeholder:"例如：距离周年纪念日"},model:{value:e.loveForm.countdownTitle,callback:function(t){e.$set(e.loveForm,"countdownTitle",t)},expression:"loveForm.countdownTitle"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"倒计时时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择倒计时目标时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.loveForm.countdownTime,callback:function(t){e.$set(e.loveForm,"countdownTime",t)},expression:"loveForm.countdownTime"}})],1)],1)],1),a("el-form-item",{attrs:{label:"额外信息"}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入额外信息，例如：我们的故事..."},model:{value:e.loveForm.familyInfo,callback:function(t){e.$set(e.loveForm,"familyInfo",t)},expression:"loveForm.familyInfo"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-switch",{attrs:{"active-text":"启用","inactive-text":"禁用"},model:{value:e.loveForm.status,callback:function(t){e.$set(e.loveForm,"status",t)},expression:"loveForm.status"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:e.uploadDialogTitle,visible:e.uploadDialogVisible,width:"40%","append-to-body":!0,"close-on-click-modal":!1,center:""},on:{"update:visible":function(t){e.uploadDialogVisible=t},close:e.handleUploadClose}},[a("uploadPicture",{key:e.currentUploadType,attrs:{isAdmin:!0,prefix:"love",maxSize:3,maxNumber:1},on:{addPicture:e.addPicture}})],1)],1)},[],!1,null,"e8314624",null);t.default=r.exports},"46d0":function(e,t,a){"use strict";a("f5e6")},f5e6:function(e,t,a){}}]);